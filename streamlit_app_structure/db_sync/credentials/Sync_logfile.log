2023-10-09 09:34:18 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 09:34:19 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table glmst in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table glheader in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table purchase in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table sales in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table return in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table stock in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table stock_value in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table cacus in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table caitem in schema public.
2023-10-09 09:34:19 - db_connector.py:108 - INFO - No data exists in the table employee in schema public.
2023-10-09 09:34:19 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 09:34:19 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 09:34:19 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 09:34:19 - sync_files.py:96 - INFO - 2874 records updated in glmst.
2023-10-09 09:34:19 - sync_files.py:117 - INFO - No missing pairs in glmst.
2023-10-09 09:34:19 - sync_files.py:15 - INFO - gldetail, None, None
2023-10-09 09:34:19 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-10-09 09:35:36 - sync_files.py:96 - INFO - 2653348 records updated in gldetail.
2023-10-09 09:35:41 - sync_files.py:117 - INFO - No missing pairs in gldetail.
2023-10-09 09:35:41 - sync_files.py:15 - INFO - glheader, None, None
2023-10-09 09:35:41 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-10-09 09:36:03 - sync_files.py:96 - INFO - 807342 records updated in glheader.
2023-10-09 09:36:06 - sync_files.py:117 - INFO - No missing pairs in glheader.
2023-10-09 09:36:06 - sync_files.py:15 - INFO - purchase, None, None
2023-10-09 09:36:06 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-10-09 09:36:07 - sync_files.py:96 - INFO - 42155 records updated in purchase.
2023-10-09 09:36:08 - sync_files.py:169 - INFO - 29 missing records added to purchase in local database.
2023-10-09 09:36:08 - sync_files.py:15 - INFO - sales, None, None
2023-10-09 09:36:08 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING ( OR  OR )
2023-10-09 09:36:08 - main.py:33 - INFO - Exception generated from local connection with error: syntax error at or near "OR"
LINE 18:              HAVING ( OR  OR )
                               ^
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 309, in sync_all
    self.execute_sync(select_sql_sales, insert_sql_sales, 'sales', column_names_sales, ztime, zutime, having_clause=True)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 63, in execute_sync
    global_cur.execute(select_sql, params)
psycopg2.errors.SyntaxError: syntax error at or near "OR"
LINE 18:              HAVING ( OR  OR )
                               ^

2023-10-09 09:36:08 - main.py:37 - INFO - Connection Closed
2023-10-09 10:05:55 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 10:05:55 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 10:05:55 - db_connector.py:106 - INFO - Data exists in the table glmst in schema public.
2023-10-09 10:05:55 - db_connector.py:106 - INFO - Data exists in the table gldetail in schema public.
2023-10-09 10:05:55 - db_connector.py:106 - INFO - Data exists in the table glheader in schema public.
2023-10-09 10:05:55 - db_connector.py:106 - INFO - Data exists in the table purchase in schema public.
2023-10-09 10:05:55 - db_connector.py:108 - INFO - No data exists in the table sales in schema public.
2023-10-09 10:05:55 - db_connector.py:108 - INFO - No data exists in the table return in schema public.
2023-10-09 10:05:55 - db_connector.py:108 - INFO - No data exists in the table stock in schema public.
2023-10-09 10:05:55 - db_connector.py:108 - INFO - No data exists in the table stock_value in schema public.
2023-10-09 10:05:55 - db_connector.py:108 - INFO - No data exists in the table cacus in schema public.
2023-10-09 10:05:55 - db_connector.py:108 - INFO - No data exists in the table caitem in schema public.
2023-10-09 10:05:55 - db_connector.py:108 - INFO - No data exists in the table employee in schema public.
2023-10-09 10:05:55 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 10:05:55 - sync_files.py:15 - INFO - glmst, 2023-07-23 16:56:24.665000, 2023-05-23 23:11:27.304000
2023-10-09 10:05:55 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-10-09 10:05:55 - sync_files.py:69 - INFO - No new updates in glmst.
2023-10-09 10:05:55 - sync_files.py:116 - INFO - No missing pairs in glmst.
2023-10-09 10:05:55 - sync_files.py:15 - INFO - gldetail, 2023-10-02 11:14:22.376000, 2023-10-02 09:43:48.485000
2023-10-09 10:05:55 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-10-09 10:05:55 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-10-09 10:06:00 - sync_files.py:116 - INFO - No missing pairs in gldetail.
2023-10-09 10:06:00 - sync_files.py:15 - INFO - glheader, 2023-10-02 11:12:52.395000, 2023-10-01 22:29:02.218000
2023-10-09 10:06:00 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-10-09 10:06:00 - sync_files.py:69 - INFO - No new updates in glheader.
2023-10-09 10:06:03 - sync_files.py:116 - INFO - No missing pairs in glheader.
2023-10-09 10:06:03 - sync_files.py:15 - INFO - purchase, 2023-10-02 11:03:45.771000, 2023-10-01 18:31:59.255000
2023-10-09 10:06:03 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-10-09 10:06:03 - sync_files.py:95 - INFO - 31 records updated in purchase.
2023-10-09 10:06:03 - sync_files.py:168 - INFO - 0 missing records added to purchase in local database.
2023-10-09 10:06:03 - sync_files.py:15 - INFO - sales, None, None
2023-10-09 10:06:03 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-10-09 10:07:23 - sync_files.py:95 - INFO - 1534322 records updated in sales.
2023-10-09 10:07:25 - sync_files.py:116 - INFO - No missing pairs in sales.
2023-10-09 10:07:26 - sync_files.py:15 - INFO - return, None, None
2023-10-09 10:07:26 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-10-09 10:07:33 - sync_files.py:95 - INFO - 205337 records updated in return.
2023-10-09 10:07:34 - sync_files.py:168 - INFO - 0 missing records added to return in local database.
2023-10-09 10:07:34 - sync_files.py:15 - INFO - stock, None, None
2023-10-09 10:07:34 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-10-09 10:07:34 - sync_files.py:95 - INFO - 3961 records updated in stock.
2023-10-09 10:07:34 - main.py:33 - INFO - Exception generated from local connection with error: unsupported operand type(s) for -: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 384, in sync_all
    self.execute_sync(select_sql_stock_value, insert_sql_stock_value, 'stock_value', column_names_stock_value, ztime-None, zutime=None, having_clause=True)
TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'
2023-10-09 10:07:34 - main.py:37 - INFO - Connection Closed
2023-10-09 10:14:10 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 10:14:11 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 10:14:11 - db_connector.py:106 - INFO - Data exists in the table glmst in schema public.
2023-10-09 10:14:11 - db_connector.py:106 - INFO - Data exists in the table gldetail in schema public.
2023-10-09 10:14:11 - db_connector.py:106 - INFO - Data exists in the table glheader in schema public.
2023-10-09 10:14:11 - db_connector.py:106 - INFO - Data exists in the table purchase in schema public.
2023-10-09 10:14:11 - db_connector.py:106 - INFO - Data exists in the table sales in schema public.
2023-10-09 10:14:11 - db_connector.py:106 - INFO - Data exists in the table return in schema public.
2023-10-09 10:14:11 - db_connector.py:108 - INFO - No data exists in the table stock in schema public.
2023-10-09 10:14:11 - db_connector.py:108 - INFO - No data exists in the table stock_value in schema public.
2023-10-09 10:14:11 - db_connector.py:108 - INFO - No data exists in the table cacus in schema public.
2023-10-09 10:14:11 - db_connector.py:108 - INFO - No data exists in the table caitem in schema public.
2023-10-09 10:14:11 - db_connector.py:108 - INFO - No data exists in the table employee in schema public.
2023-10-09 10:14:11 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 10:14:11 - sync_files.py:15 - INFO - glmst, 2023-07-23 16:56:24.665000, 2023-05-23 23:11:27.304000
2023-10-09 10:14:11 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-10-09 10:14:11 - sync_files.py:69 - INFO - No new updates in glmst.
2023-10-09 10:14:11 - sync_files.py:116 - INFO - No missing pairs in glmst.
2023-10-09 10:14:11 - sync_files.py:15 - INFO - gldetail, 2023-10-02 11:14:22.376000, 2023-10-02 09:43:48.485000
2023-10-09 10:14:11 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-10-09 10:14:11 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-10-09 10:14:16 - sync_files.py:116 - INFO - No missing pairs in gldetail.
2023-10-09 10:14:16 - sync_files.py:15 - INFO - glheader, 2023-10-02 11:12:52.395000, 2023-10-01 22:29:02.218000
2023-10-09 10:14:16 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-10-09 10:14:16 - sync_files.py:69 - INFO - No new updates in glheader.
2023-10-09 10:14:18 - sync_files.py:116 - INFO - No missing pairs in glheader.
2023-10-09 10:14:19 - sync_files.py:15 - INFO - purchase, 2023-10-02 11:03:45.771000, 2023-10-01 18:31:59.255000
2023-10-09 10:14:19 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-10-09 10:14:19 - sync_files.py:95 - INFO - 31 records updated in purchase.
2023-10-09 10:14:19 - sync_files.py:168 - INFO - 0 missing records added to purchase in local database.
2023-10-09 10:14:19 - sync_files.py:15 - INFO - sales, 2023-10-02 10:25:17.356000, 2023-10-02 10:25:17.356000
2023-10-09 10:14:19 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-10-09 10:14:23 - sync_files.py:95 - INFO - 104 records updated in sales.
2023-10-09 10:14:25 - sync_files.py:116 - INFO - No missing pairs in sales.
2023-10-09 10:14:26 - sync_files.py:15 - INFO - return, 2023-10-02 09:42:04.374000, 2022-09-22 17:47:05.444000
2023-10-09 10:14:26 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s)
2023-10-09 10:14:26 - sync_files.py:95 - INFO - 476 records updated in return.
2023-10-09 10:14:26 - sync_files.py:168 - INFO - 0 missing records added to return in local database.
2023-10-09 10:14:26 - sync_files.py:15 - INFO - stock, None, None
2023-10-09 10:14:26 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-10-09 10:14:27 - sync_files.py:95 - INFO - 3961 records updated in stock.
2023-10-09 10:14:27 - sync_files.py:15 - INFO - stock_value, None, None
2023-10-09 10:14:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-10-09 10:14:27 - sync_files.py:95 - INFO - 2274 records updated in stock_value.
2023-10-09 10:14:27 - sync_files.py:15 - INFO - cacus, None, None
2023-10-09 10:14:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2023-10-09 10:14:28 - sync_files.py:95 - INFO - 25000 records updated in cacus.
2023-10-09 10:14:28 - sync_files.py:116 - INFO - No missing pairs in cacus.
2023-10-09 10:14:28 - sync_files.py:15 - INFO - caitem, None, None
2023-10-09 10:14:28 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2023-10-09 10:14:29 - sync_files.py:95 - INFO - 5445 records updated in caitem.
2023-10-09 10:14:29 - sync_files.py:116 - INFO - No missing pairs in caitem.
2023-10-09 10:14:29 - sync_files.py:15 - INFO - employee, None, None
2023-10-09 10:14:29 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2023-10-09 10:14:29 - sync_files.py:95 - INFO - 1679 records updated in employee.
2023-10-09 10:14:29 - sync_files.py:116 - INFO - No missing pairs in employee.
2023-10-09 10:14:29 - main.py:37 - INFO - Connection Closed
2023-10-09 10:25:24 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 10:25:24 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 10:25:24 - db_connector.py:108 - INFO - No data exists in the table glmst in schema public.
2023-10-09 10:25:24 - db_connector.py:108 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 10:25:24 - db_connector.py:108 - INFO - No data exists in the table glheader in schema public.
2023-10-09 10:25:24 - db_connector.py:108 - INFO - No data exists in the table purchase in schema public.
2023-10-09 10:25:24 - db_connector.py:108 - INFO - No data exists in the table sales in schema public.
2023-10-09 10:25:24 - db_connector.py:108 - INFO - No data exists in the table return in schema public.
2023-10-09 10:25:24 - db_connector.py:111 - INFO - Error getting max itime and utime from table stock in schema public: column "itime" does not exist
LINE 2:                     SELECT MAX(itime) AS max_itime, MAX(utim...
                                       ^

2023-10-09 10:25:24 - db_connector.py:111 - INFO - Error getting max itime and utime from table stock_value in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:24 - db_connector.py:111 - INFO - Error getting max itime and utime from table cacus in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:24 - db_connector.py:111 - INFO - Error getting max itime and utime from table caitem in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:24 - db_connector.py:111 - INFO - Error getting max itime and utime from table employee in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:24 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 10:25:24 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 10:25:24 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 10:25:24 - main.py:33 - INFO - Exception generated from local connection with error: current transaction is aborted, commands ignored until end of transaction block
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 198, in sync_all
    self.execute_sync(select_sql_glmst, insert_sql_glmst, 'glmst', column_names_glmst, ztime, zutime)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 83, in execute_sync
    local_cur.execute(query)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:24 - main.py:37 - INFO - Connection Closed
2023-10-09 10:25:47 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 10:25:48 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 10:25:48 - db_connector.py:108 - INFO - No data exists in the table glmst in schema public.
2023-10-09 10:25:48 - db_connector.py:108 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 10:25:48 - db_connector.py:108 - INFO - No data exists in the table glheader in schema public.
2023-10-09 10:25:48 - db_connector.py:108 - INFO - No data exists in the table purchase in schema public.
2023-10-09 10:25:48 - db_connector.py:108 - INFO - No data exists in the table sales in schema public.
2023-10-09 10:25:48 - db_connector.py:108 - INFO - No data exists in the table return in schema public.
2023-10-09 10:25:48 - db_connector.py:111 - INFO - Error getting max itime and utime from table stock in schema public: column "itime" does not exist
LINE 2:                     SELECT MAX(itime) AS max_itime, MAX(utim...
                                       ^

2023-10-09 10:25:48 - db_connector.py:111 - INFO - Error getting max itime and utime from table stock_value in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:48 - db_connector.py:111 - INFO - Error getting max itime and utime from table cacus in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:48 - db_connector.py:111 - INFO - Error getting max itime and utime from table caitem in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:48 - db_connector.py:111 - INFO - Error getting max itime and utime from table employee in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:48 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 10:25:48 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 10:25:48 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 10:25:48 - main.py:33 - INFO - Exception generated from local connection with error: current transaction is aborted, commands ignored until end of transaction block
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 198, in sync_all
    self.execute_sync(select_sql_glmst, insert_sql_glmst, 'glmst', column_names_glmst, ztime, zutime)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 83, in execute_sync
    local_cur.execute(query)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:25:48 - main.py:37 - INFO - Connection Closed
2023-10-09 10:26:15 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 10:26:16 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 10:26:16 - db_connector.py:108 - INFO - No data exists in the table glmst in schema public.
2023-10-09 10:26:16 - db_connector.py:108 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 10:26:16 - db_connector.py:108 - INFO - No data exists in the table glheader in schema public.
2023-10-09 10:26:16 - db_connector.py:108 - INFO - No data exists in the table purchase in schema public.
2023-10-09 10:26:16 - db_connector.py:108 - INFO - No data exists in the table sales in schema public.
2023-10-09 10:26:16 - db_connector.py:108 - INFO - No data exists in the table return in schema public.
2023-10-09 10:26:16 - db_connector.py:111 - INFO - Error getting max itime and utime from table stock in schema public: column "itime" does not exist
LINE 2:                     SELECT MAX(itime) AS max_itime, MAX(utim...
                                       ^

2023-10-09 10:26:16 - db_connector.py:111 - INFO - Error getting max itime and utime from table stock_value in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:16 - db_connector.py:111 - INFO - Error getting max itime and utime from table cacus in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:16 - db_connector.py:111 - INFO - Error getting max itime and utime from table caitem in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:16 - db_connector.py:111 - INFO - Error getting max itime and utime from table employee in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:16 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 10:26:16 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 10:26:16 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 10:26:16 - main.py:33 - INFO - Exception generated from local connection with error: current transaction is aborted, commands ignored until end of transaction block
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 198, in sync_all
    self.execute_sync(select_sql_glmst, insert_sql_glmst, 'glmst', column_names_glmst, ztime, zutime)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 83, in execute_sync
    local_cur.execute(query)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:16 - main.py:37 - INFO - Connection Closed
2023-10-09 10:26:33 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 10:26:33 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 10:26:33 - db_connector.py:108 - INFO - No data exists in the table glmst in schema public.
2023-10-09 10:26:33 - db_connector.py:108 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 10:26:33 - db_connector.py:108 - INFO - No data exists in the table glheader in schema public.
2023-10-09 10:26:33 - db_connector.py:108 - INFO - No data exists in the table purchase in schema public.
2023-10-09 10:26:33 - db_connector.py:108 - INFO - No data exists in the table sales in schema public.
2023-10-09 10:26:33 - db_connector.py:108 - INFO - No data exists in the table return in schema public.
2023-10-09 10:26:33 - db_connector.py:111 - INFO - Error getting max itime and utime from table stock in schema public: column "itime" does not exist
LINE 2:                     SELECT MAX(itime) AS max_itime, MAX(utim...
                                       ^

2023-10-09 10:26:33 - db_connector.py:111 - INFO - Error getting max itime and utime from table stock_value in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:33 - db_connector.py:111 - INFO - Error getting max itime and utime from table cacus in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:33 - db_connector.py:111 - INFO - Error getting max itime and utime from table caitem in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:33 - db_connector.py:111 - INFO - Error getting max itime and utime from table employee in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:33 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 10:26:33 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 10:26:33 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 10:26:33 - main.py:33 - INFO - Exception generated from local connection with error: current transaction is aborted, commands ignored until end of transaction block
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 198, in sync_all
    self.execute_sync(select_sql_glmst, insert_sql_glmst, 'glmst', column_names_glmst, ztime, zutime)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 83, in execute_sync
    local_cur.execute(query)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:26:33 - main.py:37 - INFO - Connection Closed
2023-10-09 10:47:38 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 10:47:38 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 10:47:38 - db_connector.py:111 - INFO - No data exists in the table glmst in schema public.
2023-10-09 10:47:38 - db_connector.py:111 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 10:47:38 - db_connector.py:111 - INFO - No data exists in the table glheader in schema public.
2023-10-09 10:47:38 - db_connector.py:111 - INFO - No data exists in the table purchase in schema public.
2023-10-09 10:47:38 - db_connector.py:111 - INFO - No data exists in the table sales in schema public.
2023-10-09 10:47:38 - db_connector.py:111 - INFO - No data exists in the table return in schema public.
2023-10-09 10:47:38 - db_connector.py:114 - INFO - Error getting max itime and utime from table stock in schema public: column "itime" does not exist
LINE 2:                         SELECT MAX(itime) AS max_itime, MAX(...
                                           ^

2023-10-09 10:47:38 - db_connector.py:114 - INFO - Error getting max itime and utime from table stock_value in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:47:38 - db_connector.py:114 - INFO - Error getting max itime and utime from table cacus in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:47:38 - db_connector.py:114 - INFO - Error getting max itime and utime from table caitem in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:47:38 - db_connector.py:114 - INFO - Error getting max itime and utime from table employee in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:47:38 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 10:47:38 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 10:47:38 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 10:47:38 - main.py:33 - INFO - Exception generated from local connection with error: current transaction is aborted, commands ignored until end of transaction block
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 198, in sync_all
    self.execute_sync(select_sql_glmst, insert_sql_glmst, 'glmst', column_names_glmst, ztime, zutime)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 83, in execute_sync
    local_cur.execute(query)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:47:38 - main.py:37 - INFO - Connection Closed
2023-10-09 10:52:51 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 10:52:51 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 10:52:51 - db_connector.py:113 - INFO - No data exists in the table glmst in schema public.
2023-10-09 10:52:51 - db_connector.py:113 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 10:52:51 - db_connector.py:113 - INFO - No data exists in the table glheader in schema public.
2023-10-09 10:52:51 - db_connector.py:113 - INFO - No data exists in the table purchase in schema public.
2023-10-09 10:52:51 - db_connector.py:113 - INFO - No data exists in the table sales in schema public.
2023-10-09 10:52:51 - db_connector.py:113 - INFO - No data exists in the table return in schema public.
2023-10-09 10:52:51 - db_connector.py:116 - INFO - Error getting max itime and utime from table stock in schema public: column "itime" does not exist
LINE 2:                         SELECT MAX(itime) AS max_itime, MAX(...
                                           ^

2023-10-09 10:52:51 - db_connector.py:116 - INFO - Error getting max itime and utime from table stock_value in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:52:51 - db_connector.py:116 - INFO - Error getting max itime and utime from table cacus in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:52:51 - db_connector.py:116 - INFO - Error getting max itime and utime from table caitem in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:52:51 - db_connector.py:116 - INFO - Error getting max itime and utime from table employee in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:52:51 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 10:52:51 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 10:52:51 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 10:52:51 - main.py:33 - INFO - Exception generated from local connection with error: current transaction is aborted, commands ignored until end of transaction block
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 198, in sync_all
    self.execute_sync(select_sql_glmst, insert_sql_glmst, 'glmst', column_names_glmst, ztime, zutime)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 83, in execute_sync
    local_cur.execute(query)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 10:52:51 - main.py:37 - INFO - Connection Closed
2023-10-09 11:07:56 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 11:07:56 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 11:07:56 - db_connector.py:113 - INFO - No data exists in the table glmst in schema public.
2023-10-09 11:07:56 - db_connector.py:113 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 11:07:56 - db_connector.py:113 - INFO - No data exists in the table glheader in schema public.
2023-10-09 11:07:56 - db_connector.py:113 - INFO - No data exists in the table purchase in schema public.
2023-10-09 11:07:56 - db_connector.py:113 - INFO - No data exists in the table sales in schema public.
2023-10-09 11:07:56 - db_connector.py:113 - INFO - No data exists in the table return in schema public.
2023-10-09 11:07:56 - db_connector.py:116 - INFO - Error getting max itime and utime from table stock in schema public: column "itime" does not exist
LINE 2:                         SELECT MAX(itime) AS max_itime, MAX(...
                                           ^

2023-10-09 11:07:56 - db_connector.py:116 - INFO - Error getting max itime and utime from table stock_value in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 11:07:56 - db_connector.py:116 - INFO - Error getting max itime and utime from table cacus in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 11:07:56 - db_connector.py:116 - INFO - Error getting max itime and utime from table caitem in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 11:07:56 - db_connector.py:116 - INFO - Error getting max itime and utime from table employee in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 11:07:56 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 11:07:56 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 11:07:56 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 11:07:56 - main.py:33 - INFO - Exception generated from local connection with error: current transaction is aborted, commands ignored until end of transaction block
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 198, in sync_all
    self.execute_sync(select_sql_glmst, insert_sql_glmst, 'glmst', column_names_glmst, ztime, zutime)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 83, in execute_sync
    local_cur.execute(query)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 11:07:56 - main.py:37 - INFO - Connection Closed
2023-10-09 11:13:26 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 11:13:26 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 11:13:27 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 11:13:27 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-10-09 11:13:27 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 11:13:27 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-10-09 11:13:27 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-10-09 11:13:27 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-10-09 11:13:27 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-10-09 11:13:27 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-10-09 11:13:27 - db_connector.py:117 - INFO - Error getting max itime and utime from table stock_value in schema public: column "itime" does not exist
LINE 2:                     SELECT MAX(itime) AS max_itime, MAX(utim...
                                       ^

2023-10-09 11:13:27 - db_connector.py:117 - INFO - Error getting max itime and utime from table cacus in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 11:13:27 - db_connector.py:117 - INFO - Error getting max itime and utime from table caitem in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 11:13:27 - db_connector.py:117 - INFO - Error getting max itime and utime from table employee in schema public: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 11:13:27 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 11:13:27 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 11:13:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 11:13:27 - main.py:33 - INFO - Exception generated from local connection with error: current transaction is aborted, commands ignored until end of transaction block
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 198, in sync_all
    self.execute_sync(select_sql_glmst, insert_sql_glmst, 'glmst', column_names_glmst, ztime, zutime)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 83, in execute_sync
    local_cur.execute(query)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block

2023-10-09 11:13:27 - main.py:37 - INFO - Connection Closed
2023-10-09 11:18:10 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 11:18:11 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 11:18:11 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-10-09 11:18:11 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 11:18:11 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-10-09 11:18:11 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-10-09 11:18:11 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-10-09 11:18:11 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-10-09 11:18:11 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-10-09 11:18:11 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-10-09 11:18:11 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-10-09 11:18:11 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-10-09 11:18:11 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-10-09 11:18:11 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 11:18:11 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 11:18:11 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 11:18:11 - sync_files.py:95 - INFO - 2874 records updated in glmst.
2023-10-09 11:18:11 - sync_files.py:116 - INFO - No missing pairs in glmst.
2023-10-09 11:18:11 - sync_files.py:15 - INFO - gldetail, None, None
2023-10-09 11:18:11 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-10-09 11:19:29 - sync_files.py:95 - INFO - 2653348 records updated in gldetail.
2023-10-09 11:19:33 - sync_files.py:116 - INFO - No missing pairs in gldetail.
2023-10-09 11:19:33 - sync_files.py:15 - INFO - glheader, None, None
2023-10-09 11:19:33 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-10-09 11:19:57 - sync_files.py:95 - INFO - 807342 records updated in glheader.
2023-10-09 11:20:00 - sync_files.py:116 - INFO - No missing pairs in glheader.
2023-10-09 11:20:00 - sync_files.py:15 - INFO - purchase, None, None
2023-10-09 11:20:00 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-10-09 11:20:02 - sync_files.py:95 - INFO - 42155 records updated in purchase.
2023-10-09 11:20:02 - sync_files.py:168 - INFO - 29 missing records added to purchase in local database.
2023-10-09 11:20:02 - sync_files.py:15 - INFO - sales, None, None
2023-10-09 11:20:02 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-10-09 11:21:14 - sync_files.py:95 - INFO - 1534322 records updated in sales.
2023-10-09 11:21:16 - sync_files.py:116 - INFO - No missing pairs in sales.
2023-10-09 11:21:16 - sync_files.py:15 - INFO - return, None, None
2023-10-09 11:21:16 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-10-09 11:21:24 - sync_files.py:95 - INFO - 205337 records updated in return.
2023-10-09 11:21:24 - sync_files.py:168 - INFO - 0 missing records added to return in local database.
2023-10-09 11:21:24 - sync_files.py:15 - INFO - stock, None, None
2023-10-09 11:21:24 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-10-09 11:21:25 - sync_files.py:95 - INFO - 3961 records updated in stock.
2023-10-09 11:21:25 - sync_files.py:15 - INFO - stock_value, None, None
2023-10-09 11:21:25 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-10-09 11:21:26 - sync_files.py:95 - INFO - 2274 records updated in stock_value.
2023-10-09 11:21:26 - sync_files.py:15 - INFO - cacus, None, None
2023-10-09 11:21:26 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2023-10-09 11:21:26 - sync_files.py:95 - INFO - 25000 records updated in cacus.
2023-10-09 11:21:27 - sync_files.py:116 - INFO - No missing pairs in cacus.
2023-10-09 11:21:27 - sync_files.py:15 - INFO - caitem, None, None
2023-10-09 11:21:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2023-10-09 11:21:27 - sync_files.py:95 - INFO - 5445 records updated in caitem.
2023-10-09 11:21:27 - sync_files.py:116 - INFO - No missing pairs in caitem.
2023-10-09 11:21:27 - sync_files.py:15 - INFO - employee, None, None
2023-10-09 11:21:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2023-10-09 11:21:27 - sync_files.py:95 - INFO - 1679 records updated in employee.
2023-10-09 11:21:27 - sync_files.py:116 - INFO - No missing pairs in employee.
2023-10-09 11:21:27 - main.py:37 - INFO - Connection Closed
2023-10-09 11:48:23 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 11:48:24 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 11:48:24 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-10-09 11:48:25 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-10-09 11:48:26 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-10-09 11:48:26 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-10-09 11:48:27 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-10-09 11:48:27 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-10-09 11:48:27 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-10-09 11:48:27 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-10-09 11:48:27 - db_connector.py:112 - INFO - Data exists in the table cacus in schema public.
2023-10-09 11:48:27 - db_connector.py:112 - INFO - Data exists in the table caitem in schema public.
2023-10-09 11:48:27 - db_connector.py:112 - INFO - Data exists in the table employee in schema public.
2023-10-09 11:48:27 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 11:48:27 - sync_files.py:15 - INFO - glmst, 2023-07-23 16:56:24.665000, 2023-05-23 23:11:27.304000
2023-10-09 11:48:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-10-09 11:48:27 - sync_files.py:69 - INFO - No new updates in glmst.
2023-10-09 11:48:27 - sync_files.py:116 - INFO - No missing pairs in glmst.
2023-10-09 11:48:27 - sync_files.py:15 - INFO - gldetail, 2023-10-02 11:14:22.376000, 2023-10-02 09:43:48.485000
2023-10-09 11:48:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-10-09 11:48:27 - sync_files.py:95 - INFO - 4581 records updated in gldetail.
2023-10-09 11:48:33 - sync_files.py:168 - INFO - 362 missing records added to gldetail in local database.
2023-10-09 11:48:33 - sync_files.py:15 - INFO - glheader, 2023-10-02 11:12:52.395000, 2023-10-01 22:29:02.218000
2023-10-09 11:48:33 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-10-09 11:48:34 - sync_files.py:95 - INFO - 1042 records updated in glheader.
2023-10-09 11:48:37 - sync_files.py:168 - INFO - 195 missing records added to glheader in local database.
2023-10-09 11:48:37 - sync_files.py:15 - INFO - purchase, 2023-10-02 11:03:45.771000, 2023-10-01 18:31:59.255000
2023-10-09 11:48:37 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-10-09 11:48:37 - sync_files.py:95 - INFO - 230 records updated in purchase.
2023-10-09 11:48:37 - sync_files.py:168 - INFO - 0 missing records added to purchase in local database.
2023-10-09 11:48:37 - sync_files.py:15 - INFO - sales, 2023-10-02 10:25:17.356000, 2023-10-02 10:25:17.356000
2023-10-09 11:48:37 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-10-09 11:48:42 - sync_files.py:95 - INFO - 1731 records updated in sales.
2023-10-09 11:48:44 - sync_files.py:116 - INFO - No missing pairs in sales.
2023-10-09 11:48:45 - sync_files.py:15 - INFO - return, 2023-10-02 09:42:04.374000, 2022-09-22 17:47:05.444000
2023-10-09 11:48:45 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s)
2023-10-09 11:48:45 - sync_files.py:95 - INFO - 629 records updated in return.
2023-10-09 11:48:45 - sync_files.py:168 - INFO - 0 missing records added to return in local database.
2023-10-09 11:48:45 - sync_files.py:15 - INFO - stock, None, None
2023-10-09 11:48:45 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-10-09 11:48:46 - sync_files.py:95 - INFO - 3968 records updated in stock.
2023-10-09 11:48:46 - sync_files.py:15 - INFO - stock_value, None, None
2023-10-09 11:48:46 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-10-09 11:48:47 - sync_files.py:95 - INFO - 2287 records updated in stock_value.
2023-10-09 11:48:47 - sync_files.py:15 - INFO - cacus, 2023-09-27 18:20:23.967000, 2023-10-01 16:39:28.381000
2023-10-09 11:48:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
             WHERE (cacus.ztime > %s OR cacus.zutime > %s)
2023-10-09 11:48:47 - sync_files.py:95 - INFO - 16 records updated in cacus.
2023-10-09 11:48:47 - sync_files.py:116 - INFO - No missing pairs in cacus.
2023-10-09 11:48:47 - sync_files.py:15 - INFO - caitem, 2023-09-27 10:06:30.900000, 2023-09-30 18:44:24.504000
2023-10-09 11:48:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
             WHERE (caitem.ztime > %s OR caitem.zutime > %s)
2023-10-09 11:48:47 - sync_files.py:95 - INFO - 28 records updated in caitem.
2023-10-09 11:48:47 - sync_files.py:116 - INFO - No missing pairs in caitem.
2023-10-09 11:48:47 - sync_files.py:15 - INFO - employee, 2023-09-07 12:31:36.690000, 2023-09-14 17:39:41.080000
2023-10-09 11:48:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
             WHERE (prmst.ztime > %s OR prmst.zutime > %s)
2023-10-09 11:48:47 - sync_files.py:95 - INFO - 14 records updated in employee.
2023-10-09 11:48:47 - sync_files.py:116 - INFO - No missing pairs in employee.
2023-10-09 11:48:47 - main.py:37 - INFO - Connection Closed
2023-10-09 13:09:28 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 13:09:29 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 13:09:29 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-10-09 13:09:29 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-10-09 13:09:29 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-10-09 13:09:29 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-10-09 13:09:29 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-10-09 13:09:29 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-10-09 13:09:29 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-10-09 13:09:29 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-10-09 13:09:29 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-10-09 13:09:29 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-10-09 13:09:29 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-10-09 13:09:29 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 13:09:29 - sync_files.py:15 - INFO - glmst, None, None
2023-10-09 13:09:29 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-09 13:09:29 - sync_files.py:98 - INFO - 2874 records updated in glmst.
2023-10-09 13:09:29 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-10-09 13:09:29 - sync_files.py:15 - INFO - gldetail, None, None
2023-10-09 13:09:29 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-10-09 13:10:46 - sync_files.py:98 - INFO - 2658528 records updated in gldetail.
2023-10-09 13:10:50 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-10-09 13:10:51 - sync_files.py:15 - INFO - glheader, None, None
2023-10-09 13:10:51 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-10-09 13:11:13 - sync_files.py:98 - INFO - 808577 records updated in glheader.
2023-10-09 13:11:16 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-10-09 13:11:16 - sync_files.py:15 - INFO - purchase, None, None
2023-10-09 13:11:16 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-10-09 13:11:17 - sync_files.py:98 - INFO - 42280 records updated in purchase.
2023-10-09 13:11:18 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-10-09 13:11:18 - sync_files.py:15 - INFO - sales, None, None
2023-10-09 13:11:18 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-10-09 13:12:33 - sync_files.py:98 - INFO - 1535947 records updated in sales.
2023-10-09 13:12:36 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-10-09 13:12:36 - sync_files.py:15 - INFO - return, None, None
2023-10-09 13:12:36 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-10-09 13:12:44 - sync_files.py:98 - INFO - 205490 records updated in return.
2023-10-09 13:12:44 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-10-09 13:12:44 - sync_files.py:15 - INFO - stock, None, None
2023-10-09 13:12:44 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-10-09 13:12:45 - sync_files.py:98 - INFO - 3968 records updated in stock.
2023-10-09 13:12:45 - sync_files.py:15 - INFO - stock_value, None, None
2023-10-09 13:12:45 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-10-09 13:12:46 - sync_files.py:98 - INFO - 2287 records updated in stock_value.
2023-10-09 13:12:46 - sync_files.py:15 - INFO - cacus, None, None
2023-10-09 13:12:46 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2023-10-09 13:12:47 - sync_files.py:98 - INFO - 25010 records updated in cacus.
2023-10-09 13:12:47 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-10-09 13:12:47 - sync_files.py:15 - INFO - caitem, None, None
2023-10-09 13:12:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2023-10-09 13:12:47 - sync_files.py:98 - INFO - 5461 records updated in caitem.
2023-10-09 13:12:47 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-10-09 13:12:47 - sync_files.py:15 - INFO - employee, None, None
2023-10-09 13:12:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2023-10-09 13:12:47 - sync_files.py:98 - INFO - 1686 records updated in employee.
2023-10-09 13:12:47 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-10-09 13:12:47 - main.py:37 - INFO - Connection Closed
2023-10-09 13:18:53 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-09 13:18:53 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-09 13:18:54 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-09 13:18:54 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-09 13:18:54 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-10-09 13:18:54 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-10-09 13:18:54 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-10-09 13:18:54 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-10-09 13:18:54 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-10-09 13:18:54 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-10-09 13:18:54 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-10-09 13:18:54 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-10-09 13:18:54 - db_connector.py:112 - INFO - Data exists in the table cacus in schema public.
2023-10-09 13:18:54 - db_connector.py:112 - INFO - Data exists in the table caitem in schema public.
2023-10-09 13:18:54 - db_connector.py:112 - INFO - Data exists in the table employee in schema public.
2023-10-09 13:18:54 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-09 13:18:54 - sync_files.py:15 - INFO - glmst, 2023-07-23 16:56:24.665000, 2023-05-23 23:11:27.304000
2023-10-09 13:18:54 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-10-09 13:18:54 - sync_files.py:69 - INFO - No new updates in glmst.
2023-10-09 13:18:54 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-10-09 13:18:54 - sync_files.py:15 - INFO - gldetail, 2023-10-08 21:00:57.715000, 2023-10-08 20:56:21.846000
2023-10-09 13:18:54 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-10-09 13:18:54 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-10-09 13:18:59 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-10-09 13:18:59 - sync_files.py:15 - INFO - glheader, 2023-10-08 20:51:05.736000, 2023-10-08 18:41:44.842000
2023-10-09 13:18:59 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-10-09 13:18:59 - sync_files.py:69 - INFO - No new updates in glheader.
2023-10-09 13:19:02 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-10-09 13:19:02 - sync_files.py:15 - INFO - purchase, 2023-10-08 18:17:47.307000, 2023-10-08 11:55:58.709000
2023-10-09 13:19:02 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-10-09 13:19:02 - sync_files.py:98 - INFO - 21 records updated in purchase.
2023-10-09 13:19:02 - sync_files.py:171 - INFO - 0 missing records added to purchase in local database.
2023-10-09 13:19:02 - sync_files.py:15 - INFO - sales, 2023-10-08 21:00:27.056000, 2023-10-08 21:00:27.056000
2023-10-09 13:19:02 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-10-09 13:19:07 - sync_files.py:69 - INFO - No new updates in sales.
2023-10-09 13:19:09 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-10-09 13:19:09 - sync_files.py:15 - INFO - return, 2023-10-08 20:56:04.703000, 2022-09-22 17:47:05.444000
2023-10-09 13:19:09 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s)
2023-10-09 13:19:09 - sync_files.py:98 - INFO - 479 records updated in return.
2023-10-09 13:19:09 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-10-09 13:19:09 - sync_files.py:15 - INFO - stock, None, None
2023-10-09 13:19:09 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-10-09 13:19:10 - sync_files.py:98 - INFO - 3968 records updated in stock.
2023-10-09 13:19:10 - sync_files.py:15 - INFO - stock_value, None, None
2023-10-09 13:19:10 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-10-09 13:19:11 - sync_files.py:98 - INFO - 2287 records updated in stock_value.
2023-10-09 13:19:11 - sync_files.py:15 - INFO - cacus, 2023-10-07 18:29:50.052000, 2023-10-08 17:21:42.250000
2023-10-09 13:19:11 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
             WHERE (cacus.ztime > %s OR cacus.zutime > %s)
2023-10-09 13:19:11 - sync_files.py:69 - INFO - No new updates in cacus.
2023-10-09 13:19:11 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-10-09 13:19:11 - sync_files.py:15 - INFO - caitem, 2023-10-07 12:22:14.519000, 2023-10-08 18:20:09.538000
2023-10-09 13:19:11 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
             WHERE (caitem.ztime > %s OR caitem.zutime > %s)
2023-10-09 13:19:11 - sync_files.py:69 - INFO - No new updates in caitem.
2023-10-09 13:19:11 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-10-09 13:19:11 - sync_files.py:15 - INFO - employee, 2023-10-08 10:48:03.146000, 2023-10-08 11:41:40.908000
2023-10-09 13:19:11 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
             WHERE (prmst.ztime > %s OR prmst.zutime > %s)
2023-10-09 13:19:11 - sync_files.py:69 - INFO - No new updates in employee.
2023-10-09 13:19:11 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-10-09 13:19:11 - main.py:37 - INFO - Connection Closed
2023-10-11 14:44:35 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-11 14:44:35 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-11 14:44:35 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-10-11 14:44:35 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-10-11 14:44:35 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-10-11 14:44:35 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-10-11 14:44:35 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-10-11 14:44:35 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-10-11 14:44:35 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-10-11 14:44:35 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-10-11 14:44:35 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-10-11 14:44:35 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-10-11 14:44:35 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-10-11 14:44:35 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-11 14:44:35 - sync_files.py:15 - INFO - glmst, None, None
2023-10-11 14:44:35 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-11 14:44:36 - sync_files.py:98 - INFO - 2874 records updated in glmst.
2023-10-11 14:44:36 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-10-11 14:44:36 - sync_files.py:15 - INFO - gldetail, None, None
2023-10-11 14:44:36 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-10-11 14:45:03 - main.py:33 - INFO - Exception generated from local connection with error: column "project" of relation "gldetail" does not exist
LINE 3: ...        uuid, itime, utime, zid, ac_code, ac_sub, project, v...
                                                             ^
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 226, in sync_all
    self.execute_sync(select_sql_gldetail, insert_sql_gldetail, 'gldetail', column_names_gldetail, ztime, zutime)
  File "/Users/anilsaddatbijoy/Documents/plfolder/db_sync/sync_files.py", line 94, in execute_sync
    extras.execute_values(local_cur, insert_sql, values, template=None, page_size=100)
  File "/Users/anilsaddatbijoy/.pyenv/versions/hmbrWork/lib/python3.6/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "project" of relation "gldetail" does not exist
LINE 3: ...        uuid, itime, utime, zid, ac_code, ac_sub, project, v...
                                                             ^

2023-10-11 14:45:04 - main.py:37 - INFO - Connection Closed
2023-10-11 14:47:23 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-11 14:47:23 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-11 14:47:23 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-10-11 14:47:23 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-10-11 14:47:23 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-10-11 14:47:23 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-10-11 14:47:23 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-10-11 14:47:23 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-10-11 14:47:23 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-10-11 14:47:23 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-10-11 14:47:23 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-10-11 14:47:23 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-10-11 14:47:23 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-10-11 14:47:23 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-11 14:47:23 - sync_files.py:15 - INFO - glmst, None, None
2023-10-11 14:47:23 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-11 14:47:23 - sync_files.py:98 - INFO - 2874 records updated in glmst.
2023-10-11 14:47:23 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-10-11 14:47:23 - sync_files.py:15 - INFO - gldetail, None, None
2023-10-11 14:47:23 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-10-11 14:48:47 - sync_files.py:98 - INFO - 2658528 records updated in gldetail.
2023-10-11 14:48:52 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-10-11 14:48:52 - sync_files.py:15 - INFO - glheader, None, None
2023-10-11 14:48:52 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-10-11 14:49:15 - sync_files.py:98 - INFO - 808577 records updated in glheader.
2023-10-11 14:49:17 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-10-11 14:49:18 - sync_files.py:15 - INFO - purchase, None, None
2023-10-11 14:49:18 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-10-11 14:49:19 - sync_files.py:98 - INFO - 42280 records updated in purchase.
2023-10-11 14:49:19 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-10-11 14:49:19 - sync_files.py:15 - INFO - sales, None, None
2023-10-11 14:49:19 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-10-11 14:50:33 - sync_files.py:98 - INFO - 1535947 records updated in sales.
2023-10-11 14:50:36 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-10-11 14:50:37 - sync_files.py:15 - INFO - return, None, None
2023-10-11 14:50:37 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-10-11 14:50:44 - sync_files.py:98 - INFO - 205490 records updated in return.
2023-10-11 14:50:45 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-10-11 14:50:45 - sync_files.py:15 - INFO - stock, None, None
2023-10-11 14:50:45 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-10-11 14:50:46 - sync_files.py:98 - INFO - 3968 records updated in stock.
2023-10-11 14:50:46 - sync_files.py:15 - INFO - stock_value, None, None
2023-10-11 14:50:46 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-10-11 14:50:46 - sync_files.py:98 - INFO - 2287 records updated in stock_value.
2023-10-11 14:50:46 - sync_files.py:15 - INFO - cacus, None, None
2023-10-11 14:50:46 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2023-10-11 14:50:47 - sync_files.py:98 - INFO - 25010 records updated in cacus.
2023-10-11 14:50:47 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-10-11 14:50:47 - sync_files.py:15 - INFO - caitem, None, None
2023-10-11 14:50:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2023-10-11 14:50:48 - sync_files.py:98 - INFO - 5461 records updated in caitem.
2023-10-11 14:50:48 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-10-11 14:50:48 - sync_files.py:15 - INFO - employee, None, None
2023-10-11 14:50:48 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2023-10-11 14:50:48 - sync_files.py:98 - INFO - 1686 records updated in employee.
2023-10-11 14:50:48 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-10-11 14:50:48 - main.py:37 - INFO - Connection Closed
2023-10-15 16:29:36 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-10-15 16:29:43 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-15 16:29:43 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-10-15 16:29:45 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-10-15 16:29:46 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-10-15 16:29:46 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-10-15 16:29:47 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-10-15 16:29:47 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-10-15 16:29:47 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-10-15 16:29:47 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-10-15 16:29:47 - db_connector.py:112 - INFO - Data exists in the table cacus in schema public.
2023-10-15 16:29:47 - db_connector.py:112 - INFO - Data exists in the table caitem in schema public.
2023-10-15 16:29:47 - db_connector.py:112 - INFO - Data exists in the table employee in schema public.
2023-10-15 16:29:47 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-15 16:29:47 - sync_files.py:15 - INFO - glmst, 2023-07-23 16:56:24.665000, 2023-05-23 23:11:27.304000
2023-10-15 16:29:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-10-15 16:29:47 - sync_files.py:69 - INFO - No new updates in glmst.
2023-10-15 16:29:47 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-10-15 16:29:47 - sync_files.py:15 - INFO - gldetail, 2023-10-08 21:00:57.715000, 2023-10-08 20:56:21.846000
2023-10-15 16:29:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-10-15 16:29:48 - sync_files.py:98 - INFO - 4187 records updated in gldetail.
2023-10-15 16:29:53 - sync_files.py:171 - INFO - 465 missing records added to gldetail in local database.
2023-10-15 16:29:53 - sync_files.py:15 - INFO - glheader, 2023-10-08 20:51:05.736000, 2023-10-08 18:41:44.842000
2023-10-15 16:29:53 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-10-15 16:29:54 - sync_files.py:98 - INFO - 1236 records updated in glheader.
2023-10-15 16:29:57 - sync_files.py:171 - INFO - 257 missing records added to glheader in local database.
2023-10-15 16:29:57 - sync_files.py:15 - INFO - purchase, 2023-10-08 18:17:47.307000, 2023-10-08 11:55:58.709000
2023-10-15 16:29:57 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-10-15 16:29:57 - sync_files.py:98 - INFO - 273 records updated in purchase.
2023-10-15 16:29:57 - sync_files.py:171 - INFO - 0 missing records added to purchase in local database.
2023-10-15 16:29:57 - sync_files.py:15 - INFO - sales, 2023-10-08 21:00:27.056000, 2023-10-08 21:00:27.056000
2023-10-15 16:29:57 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-10-15 16:30:02 - sync_files.py:98 - INFO - 1666 records updated in sales.
2023-10-15 16:30:04 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-10-15 16:30:04 - sync_files.py:15 - INFO - return, 2023-10-08 20:56:04.703000, 2022-09-22 17:47:05.444000
2023-10-15 16:30:04 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s)
2023-10-15 16:30:05 - sync_files.py:98 - INFO - 657 records updated in return.
2023-10-15 16:30:05 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-10-15 16:30:05 - sync_files.py:15 - INFO - stock, None, None
2023-10-15 16:30:05 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-10-15 16:30:06 - sync_files.py:98 - INFO - 3972 records updated in stock.
2023-10-15 16:30:06 - sync_files.py:15 - INFO - stock_value, None, None
2023-10-15 16:30:06 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-10-15 16:30:07 - sync_files.py:98 - INFO - 2288 records updated in stock_value.
2023-10-15 16:30:07 - sync_files.py:15 - INFO - cacus, 2023-10-07 18:29:50.052000, 2023-10-08 17:21:42.250000
2023-10-15 16:30:07 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
             WHERE (cacus.ztime > %s OR cacus.zutime > %s)
2023-10-15 16:30:07 - sync_files.py:98 - INFO - 18 records updated in cacus.
2023-10-15 16:30:07 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-10-15 16:30:07 - sync_files.py:15 - INFO - caitem, 2023-10-07 12:22:14.519000, 2023-10-08 18:20:09.538000
2023-10-15 16:30:07 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
             WHERE (caitem.ztime > %s OR caitem.zutime > %s)
2023-10-15 16:30:07 - sync_files.py:98 - INFO - 14 records updated in caitem.
2023-10-15 16:30:07 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-10-15 16:30:07 - sync_files.py:15 - INFO - employee, 2023-10-08 10:48:03.146000, 2023-10-08 11:41:40.908000
2023-10-15 16:30:07 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
             WHERE (prmst.ztime > %s OR prmst.zutime > %s)
2023-10-15 16:30:07 - sync_files.py:98 - INFO - 1 records updated in employee.
2023-10-15 16:30:07 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-10-15 16:30:07 - main.py:37 - INFO - Connection Closed
2023-10-24 12:09:50 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-10-24 12:09:51 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-10-24 12:09:51 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-10-24 12:09:51 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-10-24 12:09:51 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-10-24 12:09:51 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-10-24 12:09:51 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-10-24 12:09:51 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-10-24 12:09:51 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-10-24 12:09:51 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-10-24 12:09:51 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-10-24 12:09:51 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-10-24 12:09:51 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-10-24 12:09:51 - sync_files.py:12 - INFO - SyncManager Initialized
2023-10-24 12:09:51 - sync_files.py:15 - INFO - glmst, None, None
2023-10-24 12:09:51 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-10-24 12:09:51 - sync_files.py:98 - INFO - 2874 records updated in glmst.
2023-10-24 12:09:51 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-10-24 12:09:51 - sync_files.py:15 - INFO - gldetail, None, None
2023-10-24 12:09:51 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-10-24 12:11:29 - sync_files.py:98 - INFO - 2668605 records updated in gldetail.
2023-10-24 12:11:35 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-10-24 12:11:35 - sync_files.py:15 - INFO - glheader, None, None
2023-10-24 12:11:35 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-10-24 12:12:00 - sync_files.py:98 - INFO - 811524 records updated in glheader.
2023-10-24 12:12:02 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-10-24 12:12:02 - sync_files.py:15 - INFO - purchase, None, None
2023-10-24 12:12:02 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-10-24 12:12:04 - sync_files.py:98 - INFO - 42483 records updated in purchase.
2023-10-24 12:12:04 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-10-24 12:12:04 - sync_files.py:15 - INFO - sales, None, None
2023-10-24 12:12:04 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-10-24 12:13:23 - sync_files.py:98 - INFO - 1540189 records updated in sales.
2023-10-24 12:13:27 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-10-24 12:13:27 - sync_files.py:15 - INFO - return, None, None
2023-10-24 12:13:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-10-24 12:13:36 - sync_files.py:98 - INFO - 205915 records updated in return.
2023-10-24 12:13:36 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-10-24 12:13:36 - sync_files.py:15 - INFO - stock, None, None
2023-10-24 12:13:36 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-10-24 12:13:37 - sync_files.py:98 - INFO - 3980 records updated in stock.
2023-10-24 12:13:37 - sync_files.py:15 - INFO - stock_value, None, None
2023-10-24 12:13:37 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-10-24 12:13:37 - sync_files.py:98 - INFO - 2289 records updated in stock_value.
2023-10-24 12:13:37 - sync_files.py:15 - INFO - cacus, None, None
2023-10-24 12:13:37 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2023-10-24 12:13:38 - sync_files.py:98 - INFO - 25046 records updated in cacus.
2023-10-24 12:13:38 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-10-24 12:13:38 - sync_files.py:15 - INFO - caitem, None, None
2023-10-24 12:13:38 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2023-10-24 12:13:38 - sync_files.py:98 - INFO - 5464 records updated in caitem.
2023-10-24 12:13:38 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-10-24 12:13:38 - sync_files.py:15 - INFO - employee, None, None
2023-10-24 12:13:38 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2023-10-24 12:13:39 - sync_files.py:98 - INFO - 1687 records updated in employee.
2023-10-24 12:13:39 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-10-24 12:13:39 - main.py:37 - INFO - Connection Closed
2023-11-06 14:50:40 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-11-06 14:50:41 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-11-06 14:50:41 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-11-06 14:50:42 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-11-06 14:50:42 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-11-06 14:50:42 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-11-06 14:50:43 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-11-06 14:50:43 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-11-06 14:50:43 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-11-06 14:50:43 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-11-06 14:50:43 - db_connector.py:112 - INFO - Data exists in the table cacus in schema public.
2023-11-06 14:50:43 - db_connector.py:112 - INFO - Data exists in the table caitem in schema public.
2023-11-06 14:50:43 - db_connector.py:112 - INFO - Data exists in the table employee in schema public.
2023-11-06 14:50:43 - sync_files.py:12 - INFO - SyncManager Initialized
2023-11-06 14:50:43 - sync_files.py:15 - INFO - glmst, 2023-07-23 16:56:24.665000, 2023-05-23 23:11:27.304000
2023-11-06 14:50:43 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-11-06 14:50:43 - sync_files.py:69 - INFO - No new updates in glmst.
2023-11-06 14:50:43 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-11-06 14:50:43 - sync_files.py:15 - INFO - gldetail, 2023-10-21 11:14:15.455000, 2023-10-21 10:30:06.187000
2023-11-06 14:50:43 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-11-06 14:50:45 - sync_files.py:98 - INFO - 8855 records updated in gldetail.
2023-11-06 14:50:50 - sync_files.py:171 - INFO - 1436 missing records added to gldetail in local database.
2023-11-06 14:50:50 - sync_files.py:15 - INFO - glheader, 2023-10-21 11:11:00.653000, 2023-10-21 09:41:43.555000
2023-11-06 14:50:50 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-11-06 14:50:51 - sync_files.py:98 - INFO - 2819 records updated in glheader.
2023-11-06 14:50:53 - sync_files.py:171 - INFO - 671 missing records added to glheader in local database.
2023-11-06 14:50:54 - sync_files.py:15 - INFO - purchase, 2023-10-21 11:00:52.424000, 2023-10-21 10:54:15.061000
2023-11-06 14:50:54 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-11-06 14:50:54 - sync_files.py:98 - INFO - 434 records updated in purchase.
2023-11-06 14:50:54 - sync_files.py:171 - INFO - 0 missing records added to purchase in local database.
2023-11-06 14:50:54 - sync_files.py:15 - INFO - sales, 2023-10-21 10:54:53.366000, 2023-10-21 10:54:53.366000
2023-11-06 14:50:54 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-11-06 14:50:59 - sync_files.py:98 - INFO - 4580 records updated in sales.
2023-11-06 14:51:01 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-11-06 14:51:01 - sync_files.py:15 - INFO - return, 2023-10-21 08:41:33.200000, 2022-09-22 17:47:05.444000
2023-11-06 14:51:01 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s)
2023-11-06 14:51:02 - sync_files.py:98 - INFO - 1048 records updated in return.
2023-11-06 14:51:02 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-11-06 14:51:02 - sync_files.py:15 - INFO - stock, None, None
2023-11-06 14:51:02 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-11-06 14:51:03 - sync_files.py:98 - INFO - 3982 records updated in stock.
2023-11-06 14:51:03 - sync_files.py:15 - INFO - stock_value, None, None
2023-11-06 14:51:03 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-11-06 14:51:03 - sync_files.py:98 - INFO - 2315 records updated in stock_value.
2023-11-06 14:51:03 - sync_files.py:15 - INFO - cacus, 2023-10-19 18:01:15.492000, 2023-10-19 17:50:12.522000
2023-11-06 14:51:03 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
             WHERE (cacus.ztime > %s OR cacus.zutime > %s)
2023-11-06 14:51:03 - sync_files.py:98 - INFO - 54 records updated in cacus.
2023-11-06 14:51:03 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-11-06 14:51:03 - sync_files.py:15 - INFO - caitem, 2023-10-15 20:52:25.927000, 2023-10-17 19:14:36.212000
2023-11-06 14:51:03 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
             WHERE (caitem.ztime > %s OR caitem.zutime > %s)
2023-11-06 14:51:03 - sync_files.py:98 - INFO - 13 records updated in caitem.
2023-11-06 14:51:03 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-11-06 14:51:03 - sync_files.py:15 - INFO - employee, 2023-10-16 12:39:11.827000, 2023-10-16 12:39:20.875000
2023-11-06 14:51:03 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
             WHERE (prmst.ztime > %s OR prmst.zutime > %s)
2023-11-06 14:51:03 - sync_files.py:98 - INFO - 2 records updated in employee.
2023-11-06 14:51:03 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-11-06 14:51:03 - main.py:37 - INFO - Connection Closed
2023-12-04 14:56:57 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-04 14:56:58 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-04 14:56:58 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-04 14:56:58 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-04 14:56:58 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-04 14:56:58 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-04 14:56:59 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-04 14:56:59 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-12-04 14:56:59 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-04 14:56:59 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-04 14:56:59 - db_connector.py:112 - INFO - Data exists in the table cacus in schema public.
2023-12-04 14:56:59 - db_connector.py:112 - INFO - Data exists in the table caitem in schema public.
2023-12-04 14:56:59 - db_connector.py:112 - INFO - Data exists in the table employee in schema public.
2023-12-04 14:56:59 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-04 14:56:59 - sync_files.py:15 - INFO - glmst, 2023-07-23 16:56:24.665000, 2023-05-23 23:11:27.304000
2023-12-04 14:56:59 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-04 14:56:59 - sync_files.py:98 - INFO - 1 records updated in glmst.
2023-12-04 14:57:00 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-04 14:57:00 - sync_files.py:15 - INFO - gldetail, 2023-11-06 13:52:09.241000, 2023-11-06 12:11:56.144000
2023-12-04 14:57:00 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-04 14:57:00 - sync_files.py:98 - INFO - 18953 records updated in gldetail.
2023-12-04 14:57:05 - sync_files.py:171 - INFO - 2516 missing records added to gldetail in local database.
2023-12-04 14:57:05 - sync_files.py:15 - INFO - glheader, 2023-11-06 13:50:30.002000, 2023-11-05 23:48:35.706000
2023-12-04 14:57:05 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-04 14:57:06 - sync_files.py:98 - INFO - 5216 records updated in glheader.
2023-12-04 14:57:09 - sync_files.py:171 - INFO - 1173 missing records added to glheader in local database.
2023-12-04 14:57:09 - sync_files.py:15 - INFO - purchase, 2023-11-06 12:30:35.313000, 2023-11-06 11:52:41.153000
2023-12-04 14:57:09 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-04 14:57:09 - sync_files.py:98 - INFO - 696 records updated in purchase.
2023-12-04 14:57:09 - sync_files.py:171 - INFO - 0 missing records added to purchase in local database.
2023-12-04 14:57:09 - sync_files.py:15 - INFO - sales, 2023-11-06 11:28:48.520000, 2023-11-06 11:28:48.520000
2023-12-04 14:57:09 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-04 14:57:15 - sync_files.py:98 - INFO - 8256 records updated in sales.
2023-12-04 14:57:18 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-12-04 14:57:18 - sync_files.py:15 - INFO - return, 2023-11-06 11:13:01.968000, 2022-09-22 17:47:05.444000
2023-12-04 14:57:18 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s)
2023-12-04 14:57:18 - sync_files.py:98 - INFO - 1542 records updated in return.
2023-12-04 14:57:19 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-12-04 14:57:19 - sync_files.py:15 - INFO - stock, None, None
2023-12-04 14:57:19 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-12-04 14:57:19 - sync_files.py:98 - INFO - 4011 records updated in stock.
2023-12-04 14:57:19 - sync_files.py:15 - INFO - stock_value, None, None
2023-12-04 14:57:19 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-12-04 14:57:20 - sync_files.py:98 - INFO - 2338 records updated in stock_value.
2023-12-04 14:57:20 - sync_files.py:15 - INFO - cacus, 2023-11-05 17:46:45.798000, 2023-11-06 09:42:28.872000
2023-12-04 14:57:20 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
             WHERE (cacus.ztime > %s OR cacus.zutime > %s)
2023-12-04 14:57:20 - sync_files.py:98 - INFO - 83 records updated in cacus.
2023-12-04 14:57:20 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-12-04 14:57:20 - sync_files.py:15 - INFO - caitem, 2023-11-01 15:35:33.770000, 2023-11-02 15:44:29.531000
2023-12-04 14:57:20 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
             WHERE (caitem.ztime > %s OR caitem.zutime > %s)
2023-12-04 14:57:20 - sync_files.py:98 - INFO - 95 records updated in caitem.
2023-12-04 14:57:20 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-12-04 14:57:20 - sync_files.py:15 - INFO - employee, 2023-10-29 12:43:41.727000, 2023-10-29 12:44:48.554000
2023-12-04 14:57:20 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
             WHERE (prmst.ztime > %s OR prmst.zutime > %s)
2023-12-04 14:57:20 - sync_files.py:98 - INFO - 39 records updated in employee.
2023-12-04 14:57:20 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-12-04 14:57:20 - main.py:37 - INFO - Connection Closed
2023-12-20 11:03:23 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-20 11:03:25 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-20 11:03:25 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-20 11:03:26 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-20 11:03:26 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-20 11:03:26 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-20 11:03:27 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-20 11:03:27 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-12-20 11:03:27 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-20 11:03:27 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-20 11:03:27 - db_connector.py:112 - INFO - Data exists in the table cacus in schema public.
2023-12-20 11:03:27 - db_connector.py:112 - INFO - Data exists in the table caitem in schema public.
2023-12-20 11:03:27 - db_connector.py:112 - INFO - Data exists in the table employee in schema public.
2023-12-20 11:03:27 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-20 11:03:27 - sync_files.py:15 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-20 11:03:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-20 11:03:27 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-20 11:03:27 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-20 11:03:27 - sync_files.py:15 - INFO - gldetail, 2023-12-04 11:13:46.967000, 2023-12-03 23:00:44.871000
2023-12-20 11:03:27 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-20 11:03:28 - sync_files.py:98 - INFO - 9888 records updated in gldetail.
2023-12-20 11:03:32 - sync_files.py:171 - INFO - 1433 missing records added to gldetail in local database.
2023-12-20 11:03:33 - sync_files.py:15 - INFO - glheader, 2023-12-04 11:11:42.134000, 2023-12-03 19:01:27.307000
2023-12-20 11:03:33 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-20 11:03:34 - sync_files.py:98 - INFO - 2573 records updated in glheader.
2023-12-20 11:03:36 - sync_files.py:171 - INFO - 651 missing records added to glheader in local database.
2023-12-20 11:03:37 - sync_files.py:15 - INFO - purchase, 2023-12-04 11:14:05.110000, 2023-11-28 10:49:13.922000
2023-12-20 11:03:37 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-20 11:03:37 - sync_files.py:98 - INFO - 506 records updated in purchase.
2023-12-20 11:03:37 - sync_files.py:171 - INFO - 0 missing records added to purchase in local database.
2023-12-20 11:03:37 - sync_files.py:15 - INFO - sales, 2023-12-04 10:20:20.639000, 2023-12-04 10:20:20.639000
2023-12-20 11:03:37 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-20 11:03:42 - sync_files.py:98 - INFO - 4094 records updated in sales.
2023-12-20 11:03:45 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-12-20 11:03:45 - sync_files.py:15 - INFO - return, 2023-12-03 21:16:20.422000, 2022-09-22 17:47:05.444000
2023-12-20 11:03:45 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s)
2023-12-20 11:03:45 - sync_files.py:98 - INFO - 1137 records updated in return.
2023-12-20 11:03:46 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-12-20 11:03:46 - sync_files.py:15 - INFO - stock, None, None
2023-12-20 11:03:46 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-12-20 11:03:47 - sync_files.py:98 - INFO - 4015 records updated in stock.
2023-12-20 11:03:47 - sync_files.py:15 - INFO - stock_value, None, None
2023-12-20 11:03:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-12-20 11:03:47 - sync_files.py:98 - INFO - 2341 records updated in stock_value.
2023-12-20 11:03:47 - sync_files.py:15 - INFO - cacus, 2023-12-03 17:27:15.659000, 2023-12-03 15:20:05.779000
2023-12-20 11:03:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
             WHERE (cacus.ztime > %s OR cacus.zutime > %s)
2023-12-20 11:03:47 - sync_files.py:98 - INFO - 46 records updated in cacus.
2023-12-20 11:03:47 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-12-20 11:03:47 - sync_files.py:15 - INFO - caitem, 2023-12-03 14:20:45.439000, 2023-12-03 19:18:00.341000
2023-12-20 11:03:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
             WHERE (caitem.ztime > %s OR caitem.zutime > %s)
2023-12-20 11:03:47 - sync_files.py:98 - INFO - 1 records updated in caitem.
2023-12-20 11:03:47 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-12-20 11:03:47 - sync_files.py:15 - INFO - employee, 2023-11-18 12:11:08.751000, 2023-11-14 09:30:07.726000
2023-12-20 11:03:47 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
             WHERE (prmst.ztime > %s OR prmst.zutime > %s)
2023-12-20 11:03:47 - sync_files.py:98 - INFO - 15 records updated in employee.
2023-12-20 11:03:47 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-12-20 11:03:47 - main.py:37 - INFO - Connection Closed
2023-12-20 11:04:32 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-20 11:04:33 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-20 11:04:33 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-20 11:04:33 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-20 11:04:33 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-20 11:04:33 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-20 11:04:33 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-20 11:04:33 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-20 11:04:33 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-20 11:04:33 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-20 11:04:33 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-20 11:04:33 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-20 11:04:33 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-20 11:04:33 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-20 11:04:33 - sync_files.py:15 - INFO - glmst, None, None
2023-12-20 11:04:33 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-20 11:04:33 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-20 11:04:33 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-20 11:04:33 - sync_files.py:15 - INFO - gldetail, None, None
2023-12-20 11:04:33 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-20 11:06:01 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-20 11:06:06 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-12-20 11:06:06 - sync_files.py:15 - INFO - glheader, None, None
2023-12-20 11:06:06 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-20 11:06:30 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-20 11:06:33 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-12-20 11:06:33 - sync_files.py:15 - INFO - purchase, None, None
2023-12-20 11:06:33 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-20 11:06:35 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-20 11:06:35 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-12-20 11:06:35 - sync_files.py:15 - INFO - sales, None, None
2023-12-20 11:06:35 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-20 11:07:53 - sync_files.py:98 - INFO - 1556551 records updated in sales.
2023-12-20 11:07:56 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-12-20 11:07:56 - sync_files.py:15 - INFO - return, None, None
2023-12-20 11:07:56 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    sum(opcdt.xqty) as returnqty, 
                    sum(opcdt.xlineamt) as treturnamt
                FROM opcrn
                JOIN opcdt
                ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-12-20 11:08:05 - sync_files.py:98 - INFO - 208058 records updated in return.
2023-12-20 11:08:05 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-12-20 11:08:05 - sync_files.py:15 - INFO - stock, None, None
2023-12-20 11:08:05 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-12-20 11:08:06 - sync_files.py:98 - INFO - 4015 records updated in stock.
2023-12-20 11:08:06 - sync_files.py:15 - INFO - stock_value, None, None
2023-12-20 11:08:06 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-12-20 11:08:06 - sync_files.py:98 - INFO - 2341 records updated in stock_value.
2023-12-20 11:08:06 - sync_files.py:15 - INFO - cacus, None, None
2023-12-20 11:08:06 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2023-12-20 11:08:07 - sync_files.py:98 - INFO - 25137 records updated in cacus.
2023-12-20 11:08:07 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-12-20 11:08:07 - sync_files.py:15 - INFO - caitem, None, None
2023-12-20 11:08:07 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2023-12-20 11:08:08 - sync_files.py:98 - INFO - 5495 records updated in caitem.
2023-12-20 11:08:08 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-12-20 11:08:08 - sync_files.py:15 - INFO - employee, None, None
2023-12-20 11:08:08 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2023-12-20 11:08:08 - sync_files.py:98 - INFO - 1701 records updated in employee.
2023-12-20 11:08:08 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-12-20 11:08:08 - main.py:37 - INFO - Connection Closed
2023-12-21 09:05:25 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 09:05:26 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 09:05:26 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 09:05:26 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 09:05:26 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 09:05:26 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 09:05:26 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 09:05:26 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 09:05:26 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 09:05:26 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 09:05:26 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 09:05:26 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 09:05:26 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 09:05:26 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 09:05:26 - sync_files.py:15 - INFO - glmst, None, None
2023-12-21 09:05:26 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 09:05:26 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 09:05:26 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-21 09:05:26 - sync_files.py:15 - INFO - gldetail, None, None
2023-12-21 09:05:26 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 09:07:26 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 09:07:26 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 09:07:26 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 09:07:26 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 09:07:26 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 09:07:26 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 09:07:26 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 09:07:26 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 09:07:26 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 09:07:26 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 09:07:26 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 09:07:26 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 09:07:26 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 09:07:26 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 09:07:26 - sync_files.py:15 - INFO - glmst, None, None
2023-12-21 09:07:26 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 09:07:26 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 09:07:26 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-21 09:07:26 - sync_files.py:15 - INFO - gldetail, None, None
2023-12-21 09:07:26 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 09:08:53 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 09:08:59 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-12-21 09:08:59 - sync_files.py:15 - INFO - glheader, None, None
2023-12-21 09:08:59 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 09:09:24 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 09:09:26 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-12-21 09:09:26 - sync_files.py:15 - INFO - purchase, None, None
2023-12-21 09:09:26 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 09:09:28 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 09:09:28 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-12-21 09:09:28 - sync_files.py:15 - INFO - sales, None, None
2023-12-21 09:09:28 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 09:10:44 - sync_files.py:98 - INFO - 1556551 records updated in sales.
2023-12-21 09:10:48 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-12-21 09:10:48 - sync_files.py:15 - INFO - return, None, None
2023-12-21 09:10:48 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid 
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-12-21 09:10:48 - main.py:33 - INFO - Exception generated from local connection with error: syntax error at or near "SUM"
LINE 13:                     SUM(imtrn.xval) as returncost
                             ^
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 343, in sync_all
    self.execute_sync(select_sql_return, insert_sql_return, 'return', column_names_return, ztime, zutime, having_clause=True)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 62, in execute_sync
    global_cur.execute(select_sql, params)
psycopg2.errors.SyntaxError: syntax error at or near "SUM"
LINE 13:                     SUM(imtrn.xval) as returncost
                             ^

2023-12-21 09:10:48 - main.py:37 - INFO - Connection Closed
2023-12-21 09:12:14 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 09:12:15 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 09:12:15 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 09:12:15 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 09:12:15 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 09:12:15 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 09:12:15 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 09:12:15 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 09:12:15 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 09:12:15 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 09:12:15 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 09:12:15 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 09:12:15 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 09:12:15 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 09:12:15 - sync_files.py:15 - INFO - glmst, None, None
2023-12-21 09:12:15 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 09:12:15 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 09:12:15 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-21 09:12:15 - sync_files.py:15 - INFO - gldetail, None, None
2023-12-21 09:12:15 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 09:13:40 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 09:13:46 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-12-21 09:13:46 - sync_files.py:15 - INFO - glheader, None, None
2023-12-21 09:13:46 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 09:14:09 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 09:14:12 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-12-21 09:14:12 - sync_files.py:15 - INFO - purchase, None, None
2023-12-21 09:14:12 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 09:14:14 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 09:14:14 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-12-21 09:14:14 - sync_files.py:15 - INFO - sales, None, None
2023-12-21 09:14:14 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 09:15:29 - sync_files.py:98 - INFO - 1556551 records updated in sales.
2023-12-21 09:15:32 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-12-21 09:15:32 - sync_files.py:15 - INFO - return, None, None
2023-12-21 09:15:32 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid 
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-12-21 09:15:34 - main.py:33 - INFO - Exception generated from local connection with error: column "returncost" of relation "return" does not exist
LINE 3: ...e, cusid, sp_id, itemcode, returnqty, treturnamt, returncost
                                                             ^
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 343, in sync_all
    self.execute_sync(select_sql_return, insert_sql_return, 'return', column_names_return, ztime, zutime, having_clause=True)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 94, in execute_sync
    extras.execute_values(local_cur, insert_sql, values, template=None, page_size=100)
  File "/Users/anilsaddatbijoy/.pyenv/versions/hmbrWork/lib/python3.6/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "returncost" of relation "return" does not exist
LINE 3: ...e, cusid, sp_id, itemcode, returnqty, treturnamt, returncost
                                                             ^

2023-12-21 09:15:35 - main.py:37 - INFO - Connection Closed
2023-12-21 09:21:09 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 09:21:10 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 09:21:10 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 09:21:10 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 09:21:10 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 09:21:10 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 09:21:10 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 09:21:10 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 09:21:10 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 09:21:10 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 09:21:10 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 09:21:10 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 09:21:10 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 09:21:10 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 09:21:10 - sync_files.py:15 - INFO - glmst, None, None
2023-12-21 09:21:10 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 09:21:10 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 09:21:10 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-21 09:21:10 - sync_files.py:15 - INFO - gldetail, None, None
2023-12-21 09:21:10 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 09:22:37 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 09:22:42 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-12-21 09:22:42 - sync_files.py:15 - INFO - glheader, None, None
2023-12-21 09:22:42 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 09:23:08 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 09:23:10 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-12-21 09:23:11 - sync_files.py:15 - INFO - purchase, None, None
2023-12-21 09:23:11 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 09:23:12 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 09:23:12 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-12-21 09:23:12 - sync_files.py:15 - INFO - sales, None, None
2023-12-21 09:23:12 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 09:24:28 - sync_files.py:98 - INFO - 1556551 records updated in sales.
2023-12-21 09:24:31 - sync_files.py:119 - INFO - No missing pairs in sales.
2023-12-21 09:24:31 - sync_files.py:15 - INFO - return, None, None
2023-12-21 09:24:31 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid 
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-12-21 09:24:38 - sync_files.py:98 - INFO - 133691 records updated in return.
2023-12-21 09:27:59 - sync_files.py:171 - INFO - 0 missing records added to return in local database.
2023-12-21 09:27:59 - sync_files.py:15 - INFO - stock, None, None
2023-12-21 09:27:59 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-12-21 09:28:00 - sync_files.py:98 - INFO - 4015 records updated in stock.
2023-12-21 09:28:00 - sync_files.py:15 - INFO - stock_value, None, None
2023-12-21 09:28:00 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-12-21 09:28:00 - sync_files.py:98 - INFO - 2341 records updated in stock_value.
2023-12-21 09:28:00 - sync_files.py:15 - INFO - cacus, None, None
2023-12-21 09:28:00 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2023-12-21 09:28:01 - sync_files.py:98 - INFO - 25137 records updated in cacus.
2023-12-21 09:28:01 - sync_files.py:119 - INFO - No missing pairs in cacus.
2023-12-21 09:28:01 - sync_files.py:15 - INFO - caitem, None, None
2023-12-21 09:28:01 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2023-12-21 09:28:01 - sync_files.py:98 - INFO - 5495 records updated in caitem.
2023-12-21 09:28:01 - sync_files.py:119 - INFO - No missing pairs in caitem.
2023-12-21 09:28:01 - sync_files.py:15 - INFO - employee, None, None
2023-12-21 09:28:01 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2023-12-21 09:28:01 - sync_files.py:98 - INFO - 1701 records updated in employee.
2023-12-21 09:28:01 - sync_files.py:119 - INFO - No missing pairs in employee.
2023-12-21 09:28:01 - main.py:37 - INFO - Connection Closed
2023-12-21 14:05:03 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 14:05:09 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 14:05:09 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 14:05:09 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 14:05:09 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 14:05:09 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 14:05:09 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 14:05:09 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 14:05:09 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 14:05:09 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 14:05:09 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 14:05:09 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 14:05:09 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 14:05:09 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 14:05:09 - sync_files.py:15 - INFO - glmst, None, None
2023-12-21 14:05:09 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 14:05:09 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 14:05:10 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-21 14:05:10 - sync_files.py:15 - INFO - gldetail, None, None
2023-12-21 14:05:10 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 14:06:38 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 14:06:43 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-12-21 14:06:43 - sync_files.py:15 - INFO - glheader, None, None
2023-12-21 14:06:43 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 14:07:08 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 14:07:10 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-12-21 14:07:11 - sync_files.py:15 - INFO - purchase, None, None
2023-12-21 14:07:11 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 14:07:12 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 14:07:12 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-12-21 14:07:12 - sync_files.py:15 - INFO - sales, None, None
2023-12-21 14:07:12 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opddt.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 14:08:02 - sync_files.py:98 - INFO - 950118 records updated in sales.
2023-12-21 14:08:05 - main.py:33 - INFO - Exception generated from local connection with error: column "opdor.zid" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18:              HAVING (opdor.zid = 100000 AND opdor.xdornum = ...
                              ^
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 313, in sync_all
    self.sync_missing_entries('sales','opdor',['zid','xdornum'],['zid','ordernumber'],select_sql_sales,insert_sql_sales)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 141, in sync_missing_entries
    global_cur.execute(select_sql, parameters)
psycopg2.errors.GroupingError: column "opdor.zid" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18:              HAVING (opdor.zid = 100000 AND opdor.xdornum = ...
                              ^

2023-12-21 14:08:06 - main.py:37 - INFO - Connection Closed
2023-12-21 14:11:43 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 14:11:43 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 14:11:43 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 14:11:43 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 14:11:43 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 14:11:43 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 14:11:43 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 14:11:43 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 14:11:43 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 14:11:43 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 14:11:43 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 14:11:43 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 14:11:43 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 14:11:43 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 14:11:43 - sync_files.py:15 - INFO - glmst, None, None
2023-12-21 14:11:43 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 14:11:43 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 14:11:43 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-21 14:11:43 - sync_files.py:15 - INFO - gldetail, None, None
2023-12-21 14:11:43 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 14:13:08 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 14:13:14 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-12-21 14:13:14 - sync_files.py:15 - INFO - glheader, None, None
2023-12-21 14:13:14 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 14:13:38 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 14:13:41 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-12-21 14:13:41 - sync_files.py:15 - INFO - purchase, None, None
2023-12-21 14:13:41 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 14:13:43 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 14:13:43 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-12-21 14:13:43 - sync_files.py:15 - INFO - sales, None, None
2023-12-21 14:13:43 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opddt.zid,opdor.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 14:14:32 - sync_files.py:98 - INFO - 950118 records updated in sales.
2023-12-21 16:14:39 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 16:14:40 - main.py:10 - INFO - Exception generated from local connection with error: FATAL:  database "stream2" does not exist
Traceback (most recent call last):
  File "main.py", line 8, in main
    local_conn = connect_to_local_db()
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/db_connector.py", line 8, in connect_to_local_db
    return psycopg2.connect(**local_db_credentials)
  File "/Users/anilsaddatbijoy/.pyenv/versions/hmbrWork/lib/python3.6/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  database "stream2" does not exist

2023-12-21 16:14:40 - main.py:25 - INFO - Exception generated from local connection with error: local variable 'local_conn' referenced before assignment
Traceback (most recent call last):
  File "main.py", line 22, in main
    create_schema(local_conn,schema_name)
UnboundLocalError: local variable 'local_conn' referenced before assignment
2023-12-21 16:15:00 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 16:15:00 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 16:15:00 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 16:15:00 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 16:15:00 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 16:15:00 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 16:15:00 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 16:15:00 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 16:15:00 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 16:15:00 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 16:15:00 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 16:15:00 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 16:15:00 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 16:15:00 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 16:15:00 - sync_files.py:15 - INFO - glmst, None, None
2023-12-21 16:15:00 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 16:15:00 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 16:15:00 - sync_files.py:119 - INFO - No missing pairs in glmst.
2023-12-21 16:15:00 - sync_files.py:15 - INFO - gldetail, None, None
2023-12-21 16:15:00 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 16:16:35 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 16:16:41 - sync_files.py:119 - INFO - No missing pairs in gldetail.
2023-12-21 16:16:41 - sync_files.py:15 - INFO - glheader, None, None
2023-12-21 16:16:41 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 16:17:09 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 16:17:13 - sync_files.py:119 - INFO - No missing pairs in glheader.
2023-12-21 16:17:13 - sync_files.py:15 - INFO - purchase, None, None
2023-12-21 16:17:13 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 16:17:15 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 16:17:15 - sync_files.py:171 - INFO - 29 missing records added to purchase in local database.
2023-12-21 16:17:15 - sync_files.py:15 - INFO - sales, None, None
2023-12-21 16:17:15 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 16:18:06 - sync_files.py:98 - INFO - 950118 records updated in sales.
2023-12-21 18:09:28 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 18:09:29 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 18:09:30 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 18:09:30 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 18:09:30 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 18:09:30 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 18:09:30 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 18:09:30 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 18:09:30 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 18:09:30 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 18:09:30 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 18:09:30 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 18:09:30 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 18:09:30 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 18:09:30 - sync_files.py:15 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 18:09:30 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 18:09:30 - sync_files.py:68 - INFO - No new updates in glmst.
2023-12-21 18:09:30 - sync_files.py:118 - INFO - No missing pairs in glmst.
2023-12-21 18:09:30 - sync_files.py:15 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 18:09:30 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 18:09:31 - sync_files.py:68 - INFO - No new updates in gldetail.
2023-12-21 18:09:39 - sync_files.py:118 - INFO - No missing pairs in gldetail.
2023-12-21 18:09:40 - sync_files.py:15 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 18:09:40 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 18:09:40 - sync_files.py:68 - INFO - No new updates in glheader.
2023-12-21 18:09:45 - sync_files.py:118 - INFO - No missing pairs in glheader.
2023-12-21 18:09:46 - sync_files.py:15 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 18:09:46 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 18:09:46 - sync_files.py:97 - INFO - 62 records updated in purchase.
2023-12-21 18:09:46 - sync_files.py:170 - INFO - 0 missing records added to purchase in local database.
2023-12-21 18:09:46 - sync_files.py:15 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 18:09:46 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 18:09:46 - main.py:33 - INFO - Exception generated from local connection with error: column "imtrn.ztime" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18: ...time > '2023-12-19T10:38:05.320000'::timestamp OR imtrn.ztim...
                                                              ^
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 311, in sync_all
    self.execute_sync(select_sql_sales, insert_sql_sales, 'sales', column_names_sales, ztime, zutime, having_clause=True)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 61, in execute_sync
    global_cur.execute(select_sql, params)
psycopg2.errors.GroupingError: column "imtrn.ztime" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18: ...time > '2023-12-19T10:38:05.320000'::timestamp OR imtrn.ztim...
                                                              ^

2023-12-21 18:09:46 - main.py:37 - INFO - Connection Closed
2023-12-21 18:13:27 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 18:13:28 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 18:13:28 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 18:13:28 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 18:13:28 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 18:13:28 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 18:13:28 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 18:13:28 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 18:13:28 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 18:13:28 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 18:13:28 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 18:13:28 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 18:13:28 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 18:13:28 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 18:13:28 - sync_files.py:15 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 18:13:28 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 18:13:28 - sync_files.py:68 - INFO - No new updates in glmst.
2023-12-21 18:13:28 - sync_files.py:118 - INFO - No missing pairs in glmst.
2023-12-21 18:13:28 - sync_files.py:15 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 18:13:28 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 18:13:29 - sync_files.py:68 - INFO - No new updates in gldetail.
2023-12-21 18:13:36 - sync_files.py:118 - INFO - No missing pairs in gldetail.
2023-12-21 18:13:37 - sync_files.py:15 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 18:13:37 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 18:13:37 - sync_files.py:68 - INFO - No new updates in glheader.
2023-12-21 18:13:42 - sync_files.py:118 - INFO - No missing pairs in glheader.
2023-12-21 18:13:42 - sync_files.py:15 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 18:13:42 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 18:13:42 - sync_files.py:97 - INFO - 62 records updated in purchase.
2023-12-21 18:13:43 - sync_files.py:170 - INFO - 0 missing records added to purchase in local database.
2023-12-21 18:13:43 - sync_files.py:15 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 18:13:43 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 18:13:43 - main.py:33 - INFO - Exception generated from local connection with error: column "imtrn.ztime" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18: ...time > '2023-12-19T10:38:05.320000'::timestamp OR imtrn.ztim...
                                                              ^
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 311, in sync_all
    # For return table
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 61, in execute_sync
    global_cur.execute(select_sql, params)
psycopg2.errors.GroupingError: column "imtrn.ztime" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18: ...time > '2023-12-19T10:38:05.320000'::timestamp OR imtrn.ztim...
                                                              ^

2023-12-21 18:13:43 - main.py:37 - INFO - Connection Closed
2023-12-21 18:14:11 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 18:14:12 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 18:14:12 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 18:14:12 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 18:14:12 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 18:14:12 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 18:14:12 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 18:14:12 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 18:14:12 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 18:14:12 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 18:14:12 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 18:14:12 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 18:14:12 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 18:14:12 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 18:14:12 - sync_files.py:15 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 18:14:12 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 18:14:12 - sync_files.py:68 - INFO - No new updates in glmst.
2023-12-21 18:14:12 - sync_files.py:118 - INFO - No missing pairs in glmst.
2023-12-21 18:14:12 - sync_files.py:15 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 18:14:12 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 18:14:13 - sync_files.py:68 - INFO - No new updates in gldetail.
2023-12-21 18:14:19 - sync_files.py:118 - INFO - No missing pairs in gldetail.
2023-12-21 18:14:20 - sync_files.py:15 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 18:14:20 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 18:14:20 - sync_files.py:68 - INFO - No new updates in glheader.
2023-12-21 18:14:24 - sync_files.py:118 - INFO - No missing pairs in glheader.
2023-12-21 18:14:25 - sync_files.py:15 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 18:14:25 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 18:14:25 - sync_files.py:97 - INFO - 62 records updated in purchase.
2023-12-21 18:14:25 - sync_files.py:170 - INFO - 0 missing records added to purchase in local database.
2023-12-21 18:14:25 - sync_files.py:15 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 18:14:25 - sync_files.py:57 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 18:14:30 - sync_files.py:97 - INFO - 111 records updated in sales.
2023-12-21 18:21:09 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 18:21:10 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 18:21:10 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 18:21:10 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 18:21:11 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 18:21:11 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 18:21:11 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 18:21:11 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 18:21:11 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 18:21:11 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 18:21:11 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 18:21:11 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 18:21:11 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 18:21:11 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 18:21:11 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 18:21:11 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 18:21:11 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 18:21:11 - sync_files.py:120 - INFO - No missing pairs in glmst.
2023-12-21 18:21:11 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 18:21:11 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 18:21:11 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 18:21:21 - sync_files.py:120 - INFO - No missing pairs in gldetail.
2023-12-21 18:21:21 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 18:21:21 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 18:21:22 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 18:21:29 - sync_files.py:120 - INFO - No missing pairs in glheader.
2023-12-21 18:21:30 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 18:21:30 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 18:21:30 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 18:21:30 - sync_files.py:172 - INFO - 0 missing records added to purchase in local database.
2023-12-21 18:21:30 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 18:21:30 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 18:21:37 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 18:29:45 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 18:29:47 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 18:29:47 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 18:29:47 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 18:29:48 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 18:29:48 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 18:29:48 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 18:29:48 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 18:29:48 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 18:29:48 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 18:29:48 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 18:29:48 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 18:29:48 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 18:29:48 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 18:29:48 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 18:29:48 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 18:29:48 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 18:29:48 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 18:29:48 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 18:29:48 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 18:29:48 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 18:30:03 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 18:30:04 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 18:30:04 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 18:30:04 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 18:30:12 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 18:30:14 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 18:30:14 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 18:30:14 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 18:30:14 - sync_files.py:174 - INFO - 0 missing records added to purchase in local database.
2023-12-21 18:30:14 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 18:30:14 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 18:30:22 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 18:39:53 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 18:39:55 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 18:39:55 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 18:39:55 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 18:39:55 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 18:39:55 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 18:39:56 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 18:39:56 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 18:39:56 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 18:39:56 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 18:39:56 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 18:39:56 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 18:39:56 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 18:39:56 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 18:39:56 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 18:39:56 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 18:39:56 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 18:39:56 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 18:39:56 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 18:39:56 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 18:39:56 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 18:40:14 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 18:40:15 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 18:40:15 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 18:40:15 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 18:40:24 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 18:40:26 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 18:40:26 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 18:40:26 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 18:40:26 - sync_files.py:175 - INFO - 0 missing records added to purchase in local database.
2023-12-21 18:40:26 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 18:40:26 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 18:40:37 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 19:05:10 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 19:05:12 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 19:05:12 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 19:05:12 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 19:05:12 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 19:05:12 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 19:05:12 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 19:05:12 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 19:05:12 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 19:05:12 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 19:05:12 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 19:05:12 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 19:05:12 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 19:05:12 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 19:05:12 - sync_files.py:16 - INFO - glmst, None, None
2023-12-21 19:05:12 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 19:05:13 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 19:05:13 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 19:05:13 - sync_files.py:16 - INFO - gldetail, None, None
2023-12-21 19:05:13 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 19:09:54 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 19:10:20 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 19:10:21 - sync_files.py:16 - INFO - glheader, None, None
2023-12-21 19:10:21 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 19:11:36 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 19:11:49 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 19:11:50 - sync_files.py:16 - INFO - purchase, None, None
2023-12-21 19:11:50 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 19:11:55 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 19:11:55 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2023-12-21 19:11:55 - sync_files.py:16 - INFO - sales, None, None
2023-12-21 19:11:55 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 19:16:16 - sync_files.py:98 - INFO - 1556551 records updated in sales.
2023-12-21 19:16:30 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-21 19:16:31 - sync_files.py:16 - INFO - return, None, None
2023-12-21 19:16:31 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-12-21 19:20:08 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 19:20:09 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 19:20:09 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 19:20:09 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 19:20:09 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 19:20:09 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 19:20:09 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 19:20:09 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 19:20:09 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 19:20:09 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 19:20:09 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 19:20:09 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 19:20:09 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 19:20:09 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 19:20:09 - sync_files.py:16 - INFO - glmst, None, None
2023-12-21 19:20:09 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 19:20:10 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 19:20:10 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 19:20:10 - sync_files.py:16 - INFO - gldetail, None, None
2023-12-21 19:20:10 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 19:24:43 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 19:25:09 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 19:25:10 - sync_files.py:16 - INFO - glheader, None, None
2023-12-21 19:25:10 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 19:26:25 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 19:26:36 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 19:26:37 - sync_files.py:16 - INFO - purchase, None, None
2023-12-21 19:26:37 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 19:26:42 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 19:26:42 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2023-12-21 19:26:42 - sync_files.py:16 - INFO - sales, None, None
2023-12-21 19:26:42 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                INNER JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                INNER JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 19:29:21 - sync_files.py:98 - INFO - 965266 records updated in sales.
2023-12-21 19:34:24 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 19:34:26 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 19:34:26 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 19:34:28 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 19:34:28 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 19:34:28 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 19:34:29 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 19:34:29 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 19:34:29 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 19:34:29 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 19:34:29 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 19:34:29 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 19:34:29 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 19:34:29 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 19:34:29 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 19:34:29 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 19:34:29 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 19:34:29 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 19:34:29 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 19:34:29 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 19:34:31 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 19:34:51 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 19:34:53 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 19:34:53 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 19:34:53 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 19:35:04 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 19:35:06 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 19:35:06 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 19:35:06 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 19:35:06 - sync_files.py:176 - INFO - 0 missing records added to purchase in local database.
2023-12-21 19:35:06 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 19:35:06 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opddt
                LEFT JOIN opdor ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opddt.xdornum = imtrn.xdocnum AND opdor.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 19:35:35 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 19:38:47 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 19:38:49 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 19:38:49 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 19:38:49 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 19:38:49 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 19:38:49 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 19:38:49 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 19:38:49 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 19:38:49 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 19:38:49 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 19:38:49 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 19:38:49 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 19:38:49 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 19:38:49 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 19:38:49 - sync_files.py:16 - INFO - glmst, None, None
2023-12-21 19:38:49 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 19:38:50 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 19:38:50 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 19:38:50 - sync_files.py:16 - INFO - gldetail, None, None
2023-12-21 19:38:50 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 19:44:06 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 19:44:44 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 19:44:45 - sync_files.py:16 - INFO - glheader, None, None
2023-12-21 19:44:45 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 19:46:05 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 19:46:17 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 19:46:18 - sync_files.py:16 - INFO - purchase, None, None
2023-12-21 19:46:18 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 19:46:23 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 19:46:24 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2023-12-21 19:46:24 - sync_files.py:16 - INFO - sales, None, None
2023-12-21 19:46:24 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 19:50:45 - sync_files.py:98 - INFO - 1556551 records updated in sales.
2023-12-21 19:51:01 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-21 19:51:02 - sync_files.py:16 - INFO - return, None, None
2023-12-21 19:51:02 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                LEFT JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                LEFT JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-12-21 19:51:42 - main.py:33 - INFO - Exception generated from local connection with error: integer out of range
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 347, in sync_all
    self.execute_sync(select_sql_return, insert_sql_return, 'return', column_names_return, ztime, zutime, having_clause=True)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 94, in execute_sync
    extras.execute_values(local_cur, insert_sql, values, template=None, page_size=100)
  File "/Users/anilsaddatbijoy/.pyenv/versions/hmbrWork/lib/python3.6/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NumericValueOutOfRange: integer out of range

2023-12-21 19:51:42 - main.py:37 - INFO - Connection Closed
2023-12-21 19:53:37 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 19:53:39 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 19:53:39 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 19:53:41 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 19:53:42 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 19:53:42 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 19:53:44 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 19:53:44 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 19:53:44 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 19:53:44 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 19:53:44 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 19:53:44 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 19:53:44 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 19:53:44 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 19:53:44 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 19:53:44 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 19:53:44 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 19:53:44 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 19:53:44 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 19:53:44 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 19:53:46 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 19:54:08 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 19:54:09 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 19:54:09 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 19:54:10 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 19:54:21 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 19:54:23 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 19:54:23 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 19:54:23 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 19:54:23 - sync_files.py:176 - INFO - 0 missing records added to purchase in local database.
2023-12-21 19:54:23 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 19:54:23 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 19:54:52 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 19:55:04 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-21 19:55:05 - sync_files.py:16 - INFO - return, None, None
2023-12-21 19:55:05 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-12-21 19:55:28 - sync_files.py:98 - INFO - 132559 records updated in return.
2023-12-21 22:18:15 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 22:18:16 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 22:18:16 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 22:18:18 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 22:18:19 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 22:18:19 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 22:18:20 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 22:18:20 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-12-21 22:18:20 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 22:18:20 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 22:18:20 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 22:18:20 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 22:18:20 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 22:18:20 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 22:18:20 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 22:18:20 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 22:18:20 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 22:18:20 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 22:18:20 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 22:18:20 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 22:18:22 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 22:18:46 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 22:18:48 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 22:18:48 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 22:18:49 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 22:19:02 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 22:19:03 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 22:19:03 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 22:19:04 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 22:19:04 - sync_files.py:176 - INFO - 0 missing records added to purchase in local database.
2023-12-21 22:19:04 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 22:19:04 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:19:36 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 22:19:47 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-21 22:19:48 - sync_files.py:16 - INFO - return, 2023-12-18 20:24:29.453000, 2022-09-22 17:47:05.444000
2023-12-21 22:19:48 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:19:48 - main.py:33 - INFO - Exception generated from local connection with error: column "imtrn.ztime" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18: ...time > '2022-09-22T17:47:05.444000'::timestamp OR imtrn.ztim...
                                                              ^
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 347, in sync_all
    self.execute_sync(select_sql_return, insert_sql_return, 'return', column_names_return, ztime, zutime, having_clause=True)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 62, in execute_sync
    global_cur.execute(select_sql, params)
psycopg2.errors.GroupingError: column "imtrn.ztime" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18: ...time > '2022-09-22T17:47:05.444000'::timestamp OR imtrn.ztim...
                                                              ^

2023-12-21 22:19:48 - main.py:37 - INFO - Connection Closed
2023-12-21 22:25:24 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 22:25:25 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 22:25:25 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 22:25:27 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 22:25:27 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 22:25:27 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 22:25:28 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 22:25:29 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-12-21 22:25:29 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 22:25:29 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 22:25:29 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 22:25:29 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 22:25:29 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 22:25:29 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 22:25:29 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 22:25:29 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 22:25:29 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 22:25:29 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 22:25:29 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 22:25:29 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 22:25:30 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 22:25:51 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 22:25:52 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 22:25:52 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 22:25:53 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 22:26:04 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 22:26:05 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 22:26:05 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 22:26:05 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 22:26:06 - sync_files.py:176 - INFO - 0 missing records added to purchase in local database.
2023-12-21 22:26:06 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 22:26:06 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:26:33 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 22:26:44 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-21 22:26:45 - sync_files.py:16 - INFO - return, 2023-12-18 20:24:29.453000, 2022-09-22 17:47:05.444000
2023-12-21 22:26:45 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:26:50 - sync_files.py:98 - INFO - 675 records updated in return.
2023-12-21 22:27:54 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 22:27:55 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 22:27:55 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 22:27:57 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 22:27:57 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 22:27:58 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 22:27:59 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 22:27:59 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-12-21 22:27:59 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 22:27:59 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 22:27:59 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 22:27:59 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 22:27:59 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 22:27:59 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 22:27:59 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 22:27:59 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 22:27:59 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 22:27:59 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 22:27:59 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 22:27:59 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 22:28:01 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 22:28:24 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 22:28:25 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 22:28:25 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 22:28:26 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 22:28:38 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 22:28:39 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 22:28:39 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 22:28:39 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 22:28:40 - sync_files.py:176 - INFO - 0 missing records added to purchase in local database.
2023-12-21 22:28:40 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 22:28:40 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:29:09 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 22:29:20 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-21 22:29:21 - sync_files.py:16 - INFO - return, 2023-12-18 20:24:29.453000, 2022-09-22 17:47:05.444000
2023-12-21 22:29:21 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                LEFT JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                LEFT JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:29:31 - sync_files.py:98 - INFO - 675 records updated in return.
2023-12-21 22:30:55 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 22:30:57 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 22:30:57 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 22:30:58 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 22:30:59 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 22:30:59 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 22:31:00 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 22:31:00 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-12-21 22:31:00 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 22:31:00 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 22:31:00 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 22:31:00 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 22:31:00 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 22:31:00 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 22:31:00 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 22:31:00 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 22:31:00 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 22:31:00 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 22:31:00 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 22:31:00 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 22:31:02 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 22:31:23 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 22:31:25 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 22:31:25 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 22:31:26 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 22:31:37 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 22:31:39 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 22:31:39 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 22:31:39 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 22:31:39 - sync_files.py:176 - INFO - 0 missing records added to purchase in local database.
2023-12-21 22:31:39 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 22:31:39 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:32:08 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 22:32:19 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-21 22:32:20 - sync_files.py:16 - INFO - return, 2023-12-18 20:24:29.453000, 2022-09-22 17:47:05.444000
2023-12-21 22:32:20 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                LEFT JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                LEFT JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:32:30 - sync_files.py:98 - INFO - 675 records updated in return.
2023-12-21 22:34:20 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table glmst already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table gldetail already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table glheader already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table purchase already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table sales already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table return already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table stock already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table stock_value already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table cacus already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table caitem already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:39 - INFO - Table employee already exists in schema public.
2023-12-21 22:34:22 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 22:34:22 - db_connector.py:112 - INFO - Data exists in the table glmst in schema public.
2023-12-21 22:34:23 - db_connector.py:112 - INFO - Data exists in the table gldetail in schema public.
2023-12-21 22:34:24 - db_connector.py:112 - INFO - Data exists in the table glheader in schema public.
2023-12-21 22:34:24 - db_connector.py:112 - INFO - Data exists in the table purchase in schema public.
2023-12-21 22:34:25 - db_connector.py:112 - INFO - Data exists in the table sales in schema public.
2023-12-21 22:34:25 - db_connector.py:112 - INFO - Data exists in the table return in schema public.
2023-12-21 22:34:25 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 22:34:25 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 22:34:25 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 22:34:25 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 22:34:25 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 22:34:25 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 22:34:25 - sync_files.py:16 - INFO - glmst, 2023-11-26 22:44:30.832000, 2023-05-23 23:11:27.304000
2023-12-21 22:34:25 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
             WHERE (glmst.ztime > %s OR glmst.zutime > %s)
2023-12-21 22:34:25 - sync_files.py:69 - INFO - No new updates in glmst.
2023-12-21 22:34:25 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 22:34:25 - sync_files.py:16 - INFO - gldetail, 2023-12-19 11:12:28.219000, 2023-12-18 21:46:05.583000
2023-12-21 22:34:25 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
             WHERE (gldetail.ztime > %s OR gldetail.zutime > %s)
2023-12-21 22:34:27 - sync_files.py:69 - INFO - No new updates in gldetail.
2023-12-21 22:34:49 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 22:34:50 - sync_files.py:16 - INFO - glheader, 2023-12-19 11:15:04.595000, 2023-12-18 21:58:20.610000
2023-12-21 22:34:50 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
             WHERE (glheader.ztime > %s OR glheader.zutime > %s)
2023-12-21 22:34:51 - sync_files.py:69 - INFO - No new updates in glheader.
2023-12-21 22:35:02 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 22:35:04 - sync_files.py:16 - INFO - purchase, 2023-12-19 10:48:52.346000, 2023-12-12 13:21:36.844000
2023-12-21 22:35:04 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
             AND (poodt.ztime > %s OR poodt.zutime > %s AND poord.ztime > %s OR poord.zutime > %s AND pogrn.ztime > %s OR pogrn.zutime > %s)
2023-12-21 22:35:04 - sync_files.py:98 - INFO - 62 records updated in purchase.
2023-12-21 22:35:04 - sync_files.py:176 - INFO - 0 missing records added to purchase in local database.
2023-12-21 22:35:04 - sync_files.py:16 - INFO - sales, 2023-12-19 10:38:05.320000, 2023-12-19 10:38:05.320000
2023-12-21 22:35:04 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
             HAVING (opddt.ztime > %s OR opddt.zutime > %s OR opdor.ztime > %s OR opdor.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:35:33 - sync_files.py:98 - INFO - 111 records updated in sales.
2023-12-21 22:35:44 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-21 22:35:45 - sync_files.py:16 - INFO - return, 2023-12-18 20:24:29.453000, 2022-09-22 17:47:05.444000
2023-12-21 22:35:45 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                INNER JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                INNER JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
             HAVING (opcdt.ztime > %s OR opcdt.zutime > %s OR opcrn.ztime > %s OR opcrn.zutime > %s OR imtrn.ztime > %s OR imtrn.zutime > %s)
2023-12-21 22:35:51 - sync_files.py:98 - INFO - 675 records updated in return.
2023-12-21 22:56:50 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 22:56:52 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 22:56:52 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 22:56:52 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 22:56:52 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 22:56:52 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 22:56:52 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 22:56:52 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 22:56:52 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 22:56:52 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 22:56:52 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 22:56:52 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 22:56:52 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 22:56:52 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 22:56:52 - sync_files.py:16 - INFO - glmst, None, None
2023-12-21 22:56:52 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 22:56:52 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 22:56:52 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 22:56:52 - sync_files.py:16 - INFO - gldetail, None, None
2023-12-21 22:56:52 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 23:02:11 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 23:02:40 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 23:02:41 - sync_files.py:16 - INFO - glheader, None, None
2023-12-21 23:02:41 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 23:04:06 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 23:04:18 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 23:04:19 - sync_files.py:16 - INFO - purchase, None, None
2023-12-21 23:04:19 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 23:04:25 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 23:04:25 - main.py:33 - INFO - Exception generated from local connection with error: 'set' object is not subscriptable
Traceback (most recent call last):
  File "main.py", line 31, in main
    sync_manager.sync_all(tables_dict)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 301, in sync_all
    self.sync_missing_entries('purchase','poord',['zid','xpornum'],['zid','povoucher'],select_sql_purchase,insert_sql_purchase)
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 146, in sync_missing_entries
    missing_batches = [missing_pairs[i:i + batch_size] for i in range(0, len(missing_pairs), batch_size)]
  File "/Users/anilsaddatbijoy/Documents/streamlit_app_structure/db_sync/sync_files.py", line 146, in <listcomp>
    missing_batches = [missing_pairs[i:i + batch_size] for i in range(0, len(missing_pairs), batch_size)]
TypeError: 'set' object is not subscriptable
2023-12-21 23:04:25 - main.py:37 - INFO - Connection Closed
2023-12-21 23:07:59 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-21 23:08:01 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-21 23:08:01 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-21 23:08:01 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-21 23:08:01 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-21 23:08:01 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-21 23:08:01 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-21 23:08:01 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-21 23:08:01 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-21 23:08:01 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-21 23:08:01 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-21 23:08:01 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-21 23:08:01 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-21 23:08:01 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-21 23:08:01 - sync_files.py:16 - INFO - glmst, None, None
2023-12-21 23:08:01 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-21 23:08:01 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-21 23:08:01 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-21 23:08:01 - sync_files.py:16 - INFO - gldetail, None, None
2023-12-21 23:08:01 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-21 23:13:06 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-21 23:13:34 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-21 23:13:35 - sync_files.py:16 - INFO - glheader, None, None
2023-12-21 23:13:35 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-21 23:14:59 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-21 23:15:11 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-21 23:15:12 - sync_files.py:16 - INFO - purchase, None, None
2023-12-21 23:15:12 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-21 23:15:18 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-21 23:15:18 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2023-12-21 23:15:18 - sync_files.py:16 - INFO - sales, None, None
2023-12-21 23:15:18 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-21 23:19:37 - sync_files.py:98 - INFO - 1556551 records updated in sales.
2023-12-21 23:19:53 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-21 23:19:54 - sync_files.py:16 - INFO - return, None, None
2023-12-21 23:19:54 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                INNER JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                INNER JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-12-21 23:20:17 - sync_files.py:98 - INFO - 133691 records updated in return.
2023-12-22 09:57:13 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2023-12-22 09:57:15 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2023-12-22 09:57:15 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2023-12-22 09:57:15 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2023-12-22 09:57:15 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2023-12-22 09:57:15 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2023-12-22 09:57:15 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2023-12-22 09:57:15 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2023-12-22 09:57:15 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2023-12-22 09:57:15 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2023-12-22 09:57:15 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2023-12-22 09:57:15 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2023-12-22 09:57:15 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2023-12-22 09:57:15 - sync_files.py:12 - INFO - SyncManager Initialized
2023-12-22 09:57:15 - sync_files.py:16 - INFO - glmst, None, None
2023-12-22 09:57:15 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2023-12-22 09:57:15 - sync_files.py:98 - INFO - 2875 records updated in glmst.
2023-12-22 09:57:15 - sync_files.py:121 - INFO - No missing pairs in glmst.
2023-12-22 09:57:15 - sync_files.py:16 - INFO - gldetail, None, None
2023-12-22 09:57:15 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2023-12-22 10:02:15 - sync_files.py:98 - INFO - 2713603 records updated in gldetail.
2023-12-22 10:02:47 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2023-12-22 10:02:49 - sync_files.py:16 - INFO - glheader, None, None
2023-12-22 10:02:49 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2023-12-22 10:04:20 - sync_files.py:98 - INFO - 824604 records updated in glheader.
2023-12-22 10:04:35 - sync_files.py:121 - INFO - No missing pairs in glheader.
2023-12-22 10:04:36 - sync_files.py:16 - INFO - purchase, None, None
2023-12-22 10:04:36 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2023-12-22 10:04:41 - sync_files.py:98 - INFO - 43577 records updated in purchase.
2023-12-22 10:04:42 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2023-12-22 10:04:42 - sync_files.py:16 - INFO - sales, None, None
2023-12-22 10:04:42 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2023-12-22 10:09:38 - sync_files.py:98 - INFO - 1556551 records updated in sales.
2023-12-22 10:09:57 - sync_files.py:121 - INFO - No missing pairs in sales.
2023-12-22 10:09:58 - sync_files.py:16 - INFO - return, None, None
2023-12-22 10:09:58 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                INNER JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                INNER JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2023-12-22 10:10:26 - sync_files.py:98 - INFO - 133691 records updated in return.
2023-12-22 10:10:26 - sync_files.py:16 - INFO - stock, None, None
2023-12-22 10:10:26 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2023-12-22 10:10:36 - sync_files.py:98 - INFO - 4015 records updated in stock.
2023-12-22 10:10:36 - sync_files.py:16 - INFO - stock_value, None, None
2023-12-22 10:10:37 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2023-12-22 10:10:44 - sync_files.py:98 - INFO - 2341 records updated in stock_value.
2023-12-22 10:10:44 - sync_files.py:16 - INFO - cacus, None, None
2023-12-22 10:10:44 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2023-12-22 10:10:47 - sync_files.py:98 - INFO - 25137 records updated in cacus.
2023-12-22 10:10:47 - sync_files.py:121 - INFO - No missing pairs in cacus.
2023-12-22 10:10:47 - sync_files.py:16 - INFO - caitem, None, None
2023-12-22 10:10:47 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2023-12-22 10:10:48 - sync_files.py:98 - INFO - 5495 records updated in caitem.
2023-12-22 10:10:48 - sync_files.py:121 - INFO - No missing pairs in caitem.
2023-12-22 10:10:48 - sync_files.py:16 - INFO - employee, None, None
2023-12-22 10:10:48 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2023-12-22 10:10:48 - sync_files.py:98 - INFO - 1701 records updated in employee.
2023-12-22 10:10:48 - sync_files.py:121 - INFO - No missing pairs in employee.
2023-12-22 10:10:48 - main.py:37 - INFO - Connection Closed
2024-01-21 15:03:03 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2024-01-21 15:03:13 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2024-01-21 15:03:13 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2024-01-21 15:03:13 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2024-01-21 15:03:13 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2024-01-21 15:03:13 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2024-01-21 15:03:13 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2024-01-21 15:03:13 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2024-01-21 15:03:13 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2024-01-21 15:03:13 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2024-01-21 15:03:13 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2024-01-21 15:03:13 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2024-01-21 15:03:13 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2024-01-21 15:03:13 - sync_files.py:12 - INFO - SyncManager Initialized
2024-01-21 15:03:13 - sync_files.py:16 - INFO - glmst, None, None
2024-01-21 15:03:13 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2024-01-21 15:03:13 - sync_files.py:98 - INFO - 2876 records updated in glmst.
2024-01-21 15:03:13 - sync_files.py:121 - INFO - No missing pairs in glmst.
2024-01-21 15:03:13 - sync_files.py:16 - INFO - gldetail, None, None
2024-01-21 15:03:13 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2024-01-21 15:04:55 - sync_files.py:98 - INFO - 2737333 records updated in gldetail.
2024-01-21 15:05:01 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2024-01-21 15:05:02 - sync_files.py:16 - INFO - glheader, None, None
2024-01-21 15:05:02 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2024-01-21 15:05:27 - sync_files.py:98 - INFO - 831462 records updated in glheader.
2024-01-21 15:05:30 - sync_files.py:121 - INFO - No missing pairs in glheader.
2024-01-21 15:05:30 - sync_files.py:16 - INFO - purchase, None, None
2024-01-21 15:05:30 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2024-01-21 15:05:32 - sync_files.py:98 - INFO - 44061 records updated in purchase.
2024-01-21 15:05:32 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2024-01-21 15:05:32 - sync_files.py:16 - INFO - sales, None, None
2024-01-21 15:05:32 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2024-01-21 15:06:54 - sync_files.py:98 - INFO - 1565528 records updated in sales.
2024-01-21 15:06:57 - sync_files.py:121 - INFO - No missing pairs in sales.
2024-01-21 15:06:58 - sync_files.py:16 - INFO - return, None, None
2024-01-21 15:06:58 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                INNER JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                INNER JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2024-01-21 15:07:04 - sync_files.py:98 - INFO - 135034 records updated in return.
2024-01-21 15:07:04 - sync_files.py:16 - INFO - stock, None, None
2024-01-21 15:07:04 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2024-01-21 15:07:05 - sync_files.py:98 - INFO - 4029 records updated in stock.
2024-01-21 15:07:05 - sync_files.py:16 - INFO - stock_value, None, None
2024-01-21 15:07:05 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2024-01-21 15:07:05 - sync_files.py:98 - INFO - 2365 records updated in stock_value.
2024-01-21 15:07:05 - sync_files.py:16 - INFO - cacus, None, None
2024-01-21 15:07:05 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2024-01-21 15:07:06 - sync_files.py:98 - INFO - 25187 records updated in cacus.
2024-01-21 15:07:06 - sync_files.py:121 - INFO - No missing pairs in cacus.
2024-01-21 15:07:06 - sync_files.py:16 - INFO - caitem, None, None
2024-01-21 15:07:06 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2024-01-21 15:07:06 - sync_files.py:98 - INFO - 5509 records updated in caitem.
2024-01-21 15:07:06 - sync_files.py:121 - INFO - No missing pairs in caitem.
2024-01-21 15:07:06 - sync_files.py:16 - INFO - employee, None, None
2024-01-21 15:07:06 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2024-01-21 15:07:07 - sync_files.py:98 - INFO - 1704 records updated in employee.
2024-01-21 15:07:07 - sync_files.py:121 - INFO - No missing pairs in employee.
2024-01-21 15:07:07 - main.py:37 - INFO - Connection Closed
2024-05-07 11:27:36 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2024-05-07 11:27:44 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2024-05-07 11:27:44 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2024-05-07 11:27:44 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2024-05-07 11:27:44 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2024-05-07 11:27:44 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2024-05-07 11:27:44 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2024-05-07 11:27:44 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2024-05-07 11:27:44 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2024-05-07 11:27:44 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2024-05-07 11:27:44 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2024-05-07 11:27:44 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2024-05-07 11:27:44 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2024-05-07 11:27:44 - sync_files.py:12 - INFO - SyncManager Initialized
2024-05-07 11:27:44 - sync_files.py:16 - INFO - glmst, None, None
2024-05-07 11:27:44 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2024-05-07 11:27:45 - sync_files.py:98 - INFO - 2877 records updated in glmst.
2024-05-07 11:27:45 - sync_files.py:121 - INFO - No missing pairs in glmst.
2024-05-07 11:27:45 - sync_files.py:16 - INFO - gldetail, None, None
2024-05-07 11:27:45 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2024-05-07 11:29:15 - sync_files.py:98 - INFO - 2804263 records updated in gldetail.
2024-05-07 11:29:21 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2024-05-07 11:29:21 - sync_files.py:16 - INFO - glheader, None, None
2024-05-07 11:29:21 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2024-05-07 11:29:46 - sync_files.py:98 - INFO - 849890 records updated in glheader.
2024-05-07 11:29:49 - sync_files.py:121 - INFO - No missing pairs in glheader.
2024-05-07 11:29:49 - sync_files.py:16 - INFO - purchase, None, None
2024-05-07 11:29:49 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2024-05-07 11:29:51 - sync_files.py:98 - INFO - 45830 records updated in purchase.
2024-05-07 11:29:51 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2024-05-07 11:29:51 - sync_files.py:16 - INFO - sales, None, None
2024-05-07 11:29:51 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2024-05-07 11:31:10 - sync_files.py:98 - INFO - 1588613 records updated in sales.
2024-05-07 11:31:13 - sync_files.py:121 - INFO - No missing pairs in sales.
2024-05-07 11:31:14 - sync_files.py:16 - INFO - return, None, None
2024-05-07 11:31:14 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                INNER JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                INNER JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2024-05-07 11:31:20 - sync_files.py:98 - INFO - 138592 records updated in return.
2024-05-07 11:31:20 - sync_files.py:16 - INFO - stock, None, None
2024-05-07 11:31:20 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2024-05-07 11:31:21 - sync_files.py:98 - INFO - 4053 records updated in stock.
2024-05-07 11:31:21 - sync_files.py:16 - INFO - stock_value, None, None
2024-05-07 11:31:21 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2024-05-07 11:31:21 - sync_files.py:98 - INFO - 2426 records updated in stock_value.
2024-05-07 11:31:21 - sync_files.py:16 - INFO - cacus, None, None
2024-05-07 11:31:21 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2024-05-07 11:31:22 - sync_files.py:98 - INFO - 25296 records updated in cacus.
2024-05-07 11:31:22 - sync_files.py:121 - INFO - No missing pairs in cacus.
2024-05-07 11:31:22 - sync_files.py:16 - INFO - caitem, None, None
2024-05-07 11:31:22 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2024-05-07 11:31:22 - sync_files.py:98 - INFO - 5554 records updated in caitem.
2024-05-07 11:31:22 - sync_files.py:121 - INFO - No missing pairs in caitem.
2024-05-07 11:31:22 - sync_files.py:16 - INFO - employee, None, None
2024-05-07 11:31:22 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2024-05-07 11:31:22 - sync_files.py:98 - INFO - 1718 records updated in employee.
2024-05-07 11:31:22 - sync_files.py:121 - INFO - No missing pairs in employee.
2024-05-07 11:31:22 - main.py:37 - INFO - Connection Closed
2024-08-11 12:46:16 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2024-08-11 12:46:24 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2024-08-11 12:46:24 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2024-08-11 12:46:24 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2024-08-11 12:46:24 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2024-08-11 12:46:24 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2024-08-11 12:46:24 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2024-08-11 12:46:24 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2024-08-11 12:46:24 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2024-08-11 12:46:24 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2024-08-11 12:46:24 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2024-08-11 12:46:24 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2024-08-11 12:46:24 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2024-08-11 12:46:24 - sync_files.py:12 - INFO - SyncManager Initialized
2024-08-11 12:46:24 - sync_files.py:16 - INFO - glmst, None, None
2024-08-11 12:46:24 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2024-08-11 12:46:24 - sync_files.py:98 - INFO - 2992 records updated in glmst.
2024-08-11 12:46:24 - sync_files.py:121 - INFO - No missing pairs in glmst.
2024-08-11 12:46:24 - sync_files.py:16 - INFO - gldetail, None, None
2024-08-11 12:46:24 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2024-08-11 12:47:49 - sync_files.py:98 - INFO - 2629334 records updated in gldetail.
2024-08-11 12:47:55 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2024-08-11 12:47:55 - sync_files.py:16 - INFO - glheader, None, None
2024-08-11 12:47:55 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2024-08-11 12:48:19 - sync_files.py:98 - INFO - 786208 records updated in glheader.
2024-08-11 12:48:21 - sync_files.py:121 - INFO - No missing pairs in glheader.
2024-08-11 12:48:22 - sync_files.py:16 - INFO - purchase, None, None
2024-08-11 12:48:22 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2024-08-11 12:48:23 - sync_files.py:98 - INFO - 46713 records updated in purchase.
2024-08-11 12:48:23 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2024-08-11 12:48:23 - sync_files.py:16 - INFO - sales, None, None
2024-08-11 12:48:23 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2024-08-11 12:49:53 - sync_files.py:98 - INFO - 1490513 records updated in sales.
2024-08-11 12:49:57 - sync_files.py:121 - INFO - No missing pairs in sales.
2024-08-11 12:49:57 - sync_files.py:16 - INFO - return, None, None
2024-08-11 12:49:57 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                INNER JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                INNER JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2024-08-11 12:50:05 - sync_files.py:98 - INFO - 129083 records updated in return.
2024-08-11 12:50:05 - sync_files.py:16 - INFO - stock, None, None
2024-08-11 12:50:05 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2024-08-11 12:50:06 - sync_files.py:98 - INFO - 4313 records updated in stock.
2024-08-11 12:50:06 - sync_files.py:16 - INFO - stock_value, None, None
2024-08-11 12:50:06 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2024-08-11 12:50:06 - sync_files.py:98 - INFO - 2158 records updated in stock_value.
2024-08-11 12:50:06 - sync_files.py:16 - INFO - cacus, None, None
2024-08-11 12:50:06 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2024-08-11 12:50:08 - sync_files.py:98 - INFO - 26541 records updated in cacus.
2024-08-11 12:50:08 - sync_files.py:121 - INFO - No missing pairs in cacus.
2024-08-11 12:50:08 - sync_files.py:16 - INFO - caitem, None, None
2024-08-11 12:50:08 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2024-08-11 12:50:08 - sync_files.py:98 - INFO - 5841 records updated in caitem.
2024-08-11 12:50:08 - sync_files.py:121 - INFO - No missing pairs in caitem.
2024-08-11 12:50:08 - sync_files.py:16 - INFO - employee, None, None
2024-08-11 12:50:08 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2024-08-11 12:50:08 - sync_files.py:98 - INFO - 1956 records updated in employee.
2024-08-11 12:50:08 - sync_files.py:121 - INFO - No missing pairs in employee.
2024-08-11 12:50:08 - main.py:37 - INFO - Connection Closed
2024-09-03 11:30:02 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2024-09-03 11:30:11 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2024-09-03 11:30:11 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2024-09-03 11:30:11 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2024-09-03 11:30:11 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2024-09-03 11:30:11 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2024-09-03 11:30:11 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2024-09-03 11:30:11 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2024-09-03 11:30:11 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2024-09-03 11:30:11 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2024-09-03 11:30:11 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2024-09-03 11:30:11 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2024-09-03 11:30:11 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2024-09-03 11:30:11 - sync_files.py:12 - INFO - SyncManager Initialized
2024-09-03 11:30:11 - sync_files.py:16 - INFO - glmst, None, None
2024-09-03 11:30:11 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2024-09-03 11:30:11 - sync_files.py:98 - INFO - 2992 records updated in glmst.
2024-09-03 11:30:11 - sync_files.py:121 - INFO - No missing pairs in glmst.
2024-09-03 11:30:11 - sync_files.py:16 - INFO - gldetail, None, None
2024-09-03 11:30:11 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2024-09-03 11:31:35 - sync_files.py:98 - INFO - 2644670 records updated in gldetail.
2024-09-03 11:31:40 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2024-09-03 11:31:41 - sync_files.py:16 - INFO - glheader, None, None
2024-09-03 11:31:41 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2024-09-03 11:32:05 - sync_files.py:98 - INFO - 790597 records updated in glheader.
2024-09-03 11:32:07 - sync_files.py:121 - INFO - No missing pairs in glheader.
2024-09-03 11:32:08 - sync_files.py:16 - INFO - purchase, None, None
2024-09-03 11:32:08 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2024-09-03 11:32:10 - sync_files.py:98 - INFO - 47053 records updated in purchase.
2024-09-03 11:32:10 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2024-09-03 11:32:10 - sync_files.py:16 - INFO - sales, None, None
2024-09-03 11:32:10 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2024-09-03 11:33:23 - sync_files.py:98 - INFO - 1495273 records updated in sales.
2024-09-03 11:33:27 - sync_files.py:121 - INFO - No missing pairs in sales.
2024-09-03 11:33:27 - sync_files.py:16 - INFO - return, None, None
2024-09-03 11:33:27 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                INNER JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                INNER JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2024-09-03 11:33:33 - sync_files.py:98 - INFO - 129774 records updated in return.
2024-09-03 11:33:33 - sync_files.py:16 - INFO - stock, None, None
2024-09-03 11:33:33 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2024-09-03 11:33:33 - sync_files.py:98 - INFO - 4317 records updated in stock.
2024-09-03 11:33:33 - sync_files.py:16 - INFO - stock_value, None, None
2024-09-03 11:33:33 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2024-09-03 11:33:34 - sync_files.py:98 - INFO - 2168 records updated in stock_value.
2024-09-03 11:33:34 - sync_files.py:16 - INFO - cacus, None, None
2024-09-03 11:33:34 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2024-09-03 11:33:35 - sync_files.py:98 - INFO - 26554 records updated in cacus.
2024-09-03 11:33:35 - sync_files.py:121 - INFO - No missing pairs in cacus.
2024-09-03 11:33:35 - sync_files.py:16 - INFO - caitem, None, None
2024-09-03 11:33:35 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2024-09-03 11:33:35 - sync_files.py:98 - INFO - 5844 records updated in caitem.
2024-09-03 11:33:35 - sync_files.py:121 - INFO - No missing pairs in caitem.
2024-09-03 11:33:35 - sync_files.py:16 - INFO - employee, None, None
2024-09-03 11:33:35 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2024-09-03 11:33:35 - sync_files.py:98 - INFO - 1960 records updated in employee.
2024-09-03 11:33:35 - sync_files.py:121 - INFO - No missing pairs in employee.
2024-09-03 11:33:35 - main.py:37 - INFO - Connection Closed
2024-09-29 18:58:34 - loggin_config.py:15 - INFO - loggin_config.py logger initialized
2024-09-29 18:58:34 - db_connector.py:67 - INFO - Schema public checked and tables created if not exist.
2024-09-29 18:58:34 - db_connector.py:114 - INFO - No data exists in the table glmst in schema public.
2024-09-29 18:58:34 - db_connector.py:114 - INFO - No data exists in the table gldetail in schema public.
2024-09-29 18:58:34 - db_connector.py:114 - INFO - No data exists in the table glheader in schema public.
2024-09-29 18:58:34 - db_connector.py:114 - INFO - No data exists in the table purchase in schema public.
2024-09-29 18:58:34 - db_connector.py:114 - INFO - No data exists in the table sales in schema public.
2024-09-29 18:58:34 - db_connector.py:114 - INFO - No data exists in the table return in schema public.
2024-09-29 18:58:34 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock in schema public.
2024-09-29 18:58:34 - db_connector.py:96 - INFO - Skipping itime and utime check for table stock_value in schema public.
2024-09-29 18:58:34 - db_connector.py:114 - INFO - No data exists in the table cacus in schema public.
2024-09-29 18:58:34 - db_connector.py:114 - INFO - No data exists in the table caitem in schema public.
2024-09-29 18:58:34 - db_connector.py:114 - INFO - No data exists in the table employee in schema public.
2024-09-29 18:58:34 - sync_files.py:12 - INFO - SyncManager Initialized
2024-09-29 18:58:34 - sync_files.py:16 - INFO - glmst, None, None
2024-09-29 18:58:34 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glmst.ztime as itime,
                    glmst.zutime as utime,
                    glmst.zid,
                    glmst.xacc as ac_code,
                    glmst.xdesc as ac_name,
                    glmst.xacctype as ac_type,
                    glmst.xhrc1 as ac_lv1,
                    glmst.xhrc2 as ac_lv2,
                    glmst.xhrc3 as ac_lv3,
                    glmst.xhrc4 as ac_lv4,
                    glmst.xaccusage as usage
                FROM glmst
            
2024-09-29 18:58:34 - sync_files.py:98 - INFO - 2992 records updated in glmst.
2024-09-29 18:58:35 - sync_files.py:121 - INFO - No missing pairs in glmst.
2024-09-29 18:58:35 - sync_files.py:16 - INFO - gldetail, None, None
2024-09-29 18:58:35 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    gldetail.ztime as itime,
                    gldetail.zutime as utime,
                    gldetail.zid,
                    gldetail.xacc as ac_code,
                    gldetail.xsub as ac_sub,
                    gldetail.xproj as project,
                    gldetail.xvoucher as voucher,
                    gldetail.xprime as value
                FROM gldetail
            
2024-09-29 18:59:59 - sync_files.py:98 - INFO - 2661838 records updated in gldetail.
2024-09-29 19:00:04 - sync_files.py:121 - INFO - No missing pairs in gldetail.
2024-09-29 19:00:04 - sync_files.py:16 - INFO - glheader, None, None
2024-09-29 19:00:04 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    glheader.ztime as itime,
                    glheader.zutime as utime,
                    glheader.zid,
                    glheader.xvoucher as voucher,
                    glheader.xdate as date,
                    glheader.xyear as year,
                    glheader.xper as month
                FROM glheader
            
2024-09-29 19:00:27 - sync_files.py:98 - INFO - 795502 records updated in glheader.
2024-09-29 19:00:29 - sync_files.py:121 - INFO - No missing pairs in glheader.
2024-09-29 19:00:29 - sync_files.py:16 - INFO - purchase, None, None
2024-09-29 19:00:29 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    poodt.ztime as itime,
                    poodt.zutime as utime,
                    poord.zid as zid,
                    COALESCE(pogrn.xdate, poord.xdate) AS combinedate,
                    poord.xpornum as povoucher,
                    pogrn.xgrnnum as grnvoucher,
                    poodt.xitem as itemcode,
                    poord.xcounterno as shipmentname,
                    poodt.xqtyord as quantity,
                    poodt.xrate as cost,
                    poord.xstatuspor as status
                FROM poord
                JOIN poodt ON poord.xpornum = poodt.xpornum AND poord.zid = poodt.zid
                LEFT JOIN pogrn ON poord.xpornum = pogrn.xpornum AND poord.zid = pogrn.zid
                WHERE poord.xstatuspor IN ('5-Received','1-Open')
            
2024-09-29 19:00:31 - sync_files.py:98 - INFO - 47403 records updated in purchase.
2024-09-29 19:00:31 - sync_files.py:176 - INFO - 29 missing records added to purchase in local database.
2024-09-29 19:00:31 - sync_files.py:16 - INFO - sales, None, None
2024-09-29 19:00:31 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opddt.ztime as itime,
                    opddt.zutime as utime,
                    opddt.zid as zid,
                    opdor.xdornum as ordernumber, 
                    opdor.xdate as date, 
                    opdor.xsp as sp_id,  
                    opdor.xcus as cusid, 
                    opddt.xitem as itemcode,
                    SUM(opddt.xqty) as quantity,
                    SUM(opddt.xlineamt) as totalsales,
                    SUM(imtrn.xval) as cost
                FROM opdor
                LEFT JOIN opddt ON opdor.xdornum = opddt.xdornum AND opdor.zid = opddt.zid
                LEFT JOIN imtrn ON opdor.xdornum = imtrn.xdocnum AND opddt.xdornum = imtrn.xdocnum AND opddt.xitem = imtrn.xitem AND opddt.zid = imtrn.zid AND opdor.zid = imtrn.zid
                GROUP BY opddt.ztime,opddt.zutime,opdor.ztime,opdor.zutime,imtrn.ztime,imtrn.zutime,opddt.zid,opdor.zid,imtrn.zid,opdor.xdornum,opddt.xdornum,imtrn.xdocnum, opdor.xdate, opdor.xsp, opdor.xcus, opddt.xitem
            
2024-09-29 19:01:42 - sync_files.py:98 - INFO - 1501058 records updated in sales.
2024-09-29 19:01:45 - sync_files.py:121 - INFO - No missing pairs in sales.
2024-09-29 19:01:45 - sync_files.py:16 - INFO - return, None, None
2024-09-29 19:01:45 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    opcdt.ztime as itime,
                    opcdt.zutime as utime,
                    opcdt.zid as zid,
                    opcrn.xcrnnum as revoucher, 
                    opcrn.xdate as date, 
                    opcrn.xcus as cusid, 
                    opcrn.xemp as sp_id,  
                    opcdt.xitem as itemcode, 
                    SUM(opcdt.xqty) as returnqty, 
                    SUM(opcdt.xlineamt) as treturnamt,
                    SUM(imtrn.xval) as returncost
                FROM opcrn
                INNER JOIN opcdt ON opcrn.xcrnnum = opcdt.xcrnnum AND opcrn.zid = opcdt.zid
                INNER JOIN imtrn ON opcrn.xcrnnum = imtrn.xdocnum AND opcdt.xcrnnum = imtrn.xdocnum AND opcdt.xitem = imtrn.xitem AND opcdt.zid = imtrn.zid AND opcrn.zid = imtrn.zid
                GROUP BY opcdt.ztime,opcdt.zutime,opcrn.ztime,opcrn.zutime,imtrn.ztime,imtrn.zutime,opcdt.zid,opcrn.zid,imtrn.zid,opcrn.xcrnnum,opcdt.xcrnnum,imtrn.xdocnum,opcrn.xdate,opcrn.xcus,opcrn.xemp,opcdt.xitem
            
2024-09-29 19:01:51 - sync_files.py:98 - INFO - 130558 records updated in return.
2024-09-29 19:01:51 - sync_files.py:16 - INFO - stock, None, None
2024-09-29 19:01:51 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xitem as itemcode,
                    SUM(imtrn.xqty * imtrn.xsign) as stockqty,
                    SUM(imtrn.xval * imtrn.xsign) AS stockvalue
                FROM imtrn
                GROUP BY imtrn.zid,imtrn.xitem
            
2024-09-29 19:01:52 - sync_files.py:98 - INFO - 4321 records updated in stock.
2024-09-29 19:01:52 - sync_files.py:16 - INFO - stock_value, None, None
2024-09-29 19:01:52 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    imtrn.zid as zid,
                    imtrn.xyear as year,
                    imtrn.xper as month,
                    imtrn.xwh as warehouse,
                    SUM(imtrn.xval * imtrn.xsign) as stockvalue 
                FROM imtrn
                GROUP BY imtrn.zid, imtrn.xyear, imtrn.xper, imtrn.xwh
            
2024-09-29 19:01:52 - sync_files.py:98 - INFO - 2176 records updated in stock_value.
2024-09-29 19:01:52 - sync_files.py:16 - INFO - cacus, None, None
2024-09-29 19:01:52 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    cacus.ztime as itime,
                    cacus.zutime as utime,
                    cacus.zid as zid,
                    cacus.xcus as cusid,
                    cacus.xshort as cusname,
                    cacus.xadd2 as cusadd,
                    cacus.xcity as cuscity,
                    cacus.xstate as cusstate,
                    cacus.xmobile as cusmobile,
                    cacus.xtaxnum as cusmobile2
                FROM cacus
            
2024-09-29 19:01:53 - sync_files.py:98 - INFO - 26595 records updated in cacus.
2024-09-29 19:01:53 - sync_files.py:121 - INFO - No missing pairs in cacus.
2024-09-29 19:01:53 - sync_files.py:16 - INFO - caitem, None, None
2024-09-29 19:01:53 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    caitem.ztime as itime,
                    caitem.zutime as utime,
                    caitem.zid as zid,
                    caitem.xitem as itemcode,
                    caitem.xdesc as itemname,
                    caitem.xgitem as itemgroup,
                    caitem.xabc as itemgroup2,
                    caitem.xscode as packcode
                FROM caitem
            
2024-09-29 19:01:54 - sync_files.py:98 - INFO - 5847 records updated in caitem.
2024-09-29 19:01:54 - sync_files.py:121 - INFO - No missing pairs in caitem.
2024-09-29 19:01:54 - sync_files.py:16 - INFO - employee, None, None
2024-09-29 19:01:54 - sync_files.py:58 - INFO - Modified SQL Query: 
                SELECT 
                    prmst.ztime as itime,
                    prmst.zutime as utime,
                    prmst.zid as zid,
                    prmst.xemp as spid,
                    prmst.xname as spname,
                    prmst.xdept as department,
                    prmst.xdesig as designation
                FROM prmst
            
2024-09-29 19:01:54 - sync_files.py:98 - INFO - 1967 records updated in employee.
2024-09-29 19:01:54 - sync_files.py:121 - INFO - No missing pairs in employee.
2024-09-29 19:01:54 - main.py:37 - INFO - Connection Closed
